{
  "metadata": {
    "repository": "elastic/elasticsearch",
    "start_date": "2024-01-09",
    "end_date": "2024-01-16",
    "extraction_timestamp": "2025-01-16T10:47:48.733925",
    "metrics": {
      "execution_time": {
        "seconds": 131.84,
        "formatted": "2min 11s"
      },
      "api_usage": {
        "total_requests": 166,
        "total_prs_collected": 55,
        "pages_processed": 1,
        "average_request_time": "0s",
        "rate_limit": {
          "total": "30",
          "remaining": "29",
          "used_in_session": 1,
          "reset_time": "Unknown"
        }
      }
    }
  },
  "pull_requests": [
    {
      "number": 104438,
      "title": "Increment failuresAfterMeaningfulProgress before retry",
      "state": "closed",
      "created_at": "2024-01-16T23:30:00Z",
      "updated_at": "2024-01-29T12:16:59Z",
      "closed_at": "2024-01-29T12:16:36Z",
      "merged_at": "2024-01-29T12:16:36Z",
      "author": "ywangd",
      "labels": [
        ">test",
        ":Distributed Coordination/Snapshot/Restore",
        "Team:Distributed (Obsolete)",
        "auto-merge-without-approval",
        "v8.13.0"
      ],
      "comments_count": 3,
      "review_comments_count": 2,
      "additions": 9,
      "deletions": 7,
      "changed_files": 2,
      "url": "https://github.com/elastic/elasticsearch/pull/104438",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104438",
      "commits": [
        {
          "sha": "fe1e55b7fcdd356d9f9ba50d36547c7f35bb7095",
          "message": "Increment failuresAfterMeaningfulProgress before retry\n\nThe count for failuresAfterMeaningfulProgress should be incremented\nbefore testing whether to retry s3 blob read. In addition, it should not\nbe incremented on stream openning failures.\n\nResolves: #104436"
        },
        {
          "sha": "61e20e9f3a09f130f557031ab934d222a371fcca",
          "message": "Merge branch 'main' into es-104436-retry-after-meaningful-progress"
        },
        {
          "sha": "9d31e189677ffe358fcc3e69471cff3c4d48a741",
          "message": "extract method"
        },
        {
          "sha": "e1421217c2f00d9c94eb8b43f37d3b87f1ccc7f1",
          "message": "Merge remote-tracking branch 'origin/main' into es-104436-retry-after-meaningful-progress"
        }
      ],
      "comments": [
        {
          "user": "DaveCTurner",
          "body": "I'd be inclined to extract this as a private method rather than duplicate the expression, especially since inlining it like this loses the name that explains what it really means."
        },
        {
          "user": "ywangd",
          "body": "Makes sense. See 9d31e189677ffe358fcc3e69471cff3c4d48a741"
        }
      ],
      "body": "The count for failuresAfterMeaningfulProgress should be incremented before testing whether to retry s3 blob read. This is because we do not want to count failuresAfterMeaningfulProgress towards actual number of failures, i.e. we want to keep retrying if the last attempt has made meaningful progress. \r\nIn addition, failuresAfterMeaningfulProgress should _not_ be incremented on stream openning failures.\r\n\r\nResolves: #104436\r\n",
      "base_ref": "main",
      "head_ref": "es-104436-retry-after-meaningful-progress",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104438/comments"
    },
    {
      "number": 104420,
      "title": "Fix the assertion in MetricApmIT",
      "state": "closed",
      "created_at": "2024-01-16T16:33:04Z",
      "updated_at": "2024-10-29T11:54:29Z",
      "closed_at": "2024-01-18T10:49:13Z",
      "merged_at": "2024-01-18T10:49:13Z",
      "author": "pgomulka",
      "labels": [
        ">test",
        ":Core/Infra/Core",
        "Team:Core/Infra",
        "v8.13.0"
      ],
      "comments_count": 2,
      "review_comments_count": 0,
      "additions": 4,
      "deletions": 3,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104420",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104420",
      "commits": [
        {
          "sha": "a5f7b9afc1792c3cc229c02b7bc8c5de4cce5bcc",
          "message": "Fix the assertion in MetricApmIT\n\nThe test should print out the assertions that were not matched if it has\nnot managed to finish within 30s\nrelates https://github.com/elastic/elasticsearch/issues/103286"
        },
        {
          "sha": "fb233661400fe4f9db1e76ccf34bc8c506d4c578",
          "message": "Merge branch 'main' into fix_metrics_apm_assertion"
        },
        {
          "sha": "d6cc904016ecd636a8e21c78e83d1fdc31656fe5",
          "message": "spotless"
        },
        {
          "sha": "0b84c2d995ed5c3ce936428743f6be378065ccea",
          "message": "Merge branch 'fix_metrics_apm_assertion' of github.com:pgomulka/elasticsearch into fix_metrics_apm_assertion"
        }
      ],
      "comments": [],
      "body": "The test should print out the assertions that were not matched if it has not managed to finish within 30s\r\nrelates https://github.com/elastic/elasticsearch/issues/103286\r\n\r\n\r\n",
      "base_ref": "main",
      "head_ref": "fix_metrics_apm_assertion",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104420/comments"
    },
    {
      "number": 104404,
      "title": "[8.12] Simplify the int8_hnsw MIP yaml test (#104331)",
      "state": "closed",
      "created_at": "2024-01-16T13:08:48Z",
      "updated_at": "2024-01-16T13:49:52Z",
      "closed_at": "2024-01-16T13:49:29Z",
      "merged_at": "2024-01-16T13:49:29Z",
      "author": "benwtrent",
      "labels": [
        ">test",
        "backport",
        "Team:Search",
        "auto-merge-without-approval",
        ":Search Relevance/Vectors",
        "v8.12.1"
      ],
      "comments_count": 0,
      "review_comments_count": 0,
      "additions": 5,
      "deletions": 5,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104404",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104404",
      "commits": [
        {
          "sha": "b5f125110f06ca364b0b22298cf3e2507ca955f8",
          "message": "Simplify the int8_hnsw MIP yaml test (#104331)\n\nThe test is unnecessarily complicated with its vectors. This simplifies\nthe vectors and the test. We mainly care about extreme weirdness &\nserver level failures.\n\ncloses: https://github.com/elastic/elasticsearch/issues/104297"
        }
      ],
      "comments": [],
      "body": "Backports the following commits to 8.12:\n - Simplify the int8_hnsw MIP yaml test (#104331)",
      "base_ref": "8.12",
      "head_ref": "backport/8.12/pr-104331",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104404/comments"
    },
    {
      "number": 104392,
      "title": "Use LogDocMergePolicy in VariableWidthHistogramAggregatorTests",
      "state": "closed",
      "created_at": "2024-01-16T10:04:01Z",
      "updated_at": "2024-01-23T09:45:54Z",
      "closed_at": "2024-01-17T14:01:49Z",
      "merged_at": "2024-01-17T14:01:49Z",
      "author": "iverase",
      "labels": [
        ">test",
        ":Analytics/Aggregations",
        "Team:Analytics",
        "v8.12.1",
        "v8.13.0"
      ],
      "comments_count": 1,
      "review_comments_count": 0,
      "additions": 8,
      "deletions": 1,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104392",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104392",
      "commits": [
        {
          "sha": "358c192e660259c18fc58cf9732263e3510f54cd",
          "message": "Use LogDocMergePolicy in VariableWidthHistogramAggregatorTests"
        }
      ],
      "comments": [],
      "body": "The latest lucene upgrade adds a new merge policy that reverse the order of the documents. To avoid randomisation we hardcode the merge policy to LogDocMergePolicy.\r\n\r\nrelates https://github.com/elastic/elasticsearch/pull/103040\r\n\r\nfixes https://github.com/elastic/elasticsearch/issues/103976\r\nfixes https://github.com/elastic/elasticsearch/issues/104316",
      "base_ref": "main",
      "head_ref": "VariableWidthHistogramAggregatorTests",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104392/comments"
    },
    {
      "number": 104391,
      "title": "Fix testListTasksWaitForCompletion",
      "state": "closed",
      "created_at": "2024-01-16T09:35:29Z",
      "updated_at": "2024-02-05T13:11:50Z",
      "closed_at": "2024-02-05T13:11:47Z",
      "merged_at": "2024-02-05T13:11:47Z",
      "author": "idegtiarenko",
      "labels": [
        ">test",
        ":Distributed Coordination/Task Management",
        "Team:Distributed (Obsolete)",
        "v8.13.0"
      ],
      "comments_count": 2,
      "review_comments_count": 6,
      "additions": 58,
      "deletions": 60,
      "changed_files": 2,
      "url": "https://github.com/elastic/elasticsearch/pull/104391",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104391",
      "commits": [
        {
          "sha": "6433b0e3ccd87e862ec79d07e43aa6075e8f1b56",
          "message": "Fix testListTasksWaitForCompletion\n\nThis change attempts to fix testListTasksWaitForCompletion by setting bariers to\n verify task started on all nodes and had a chance to list all running tasks\n before canceling the TEST_TASK"
        },
        {
          "sha": "d18f21cf1f31f4e7c5262fa506cfaaea70c28b8a",
          "message": "Merge branch 'main' into fix_97923\n\n# Conflicts:\n#\tserver/src/main/java/org/elasticsearch/action/admin/cluster/node/tasks/list/TransportListTasksAction.java"
        },
        {
          "sha": "39c6e2256a772778cd71654f60090aadae4b3de8",
          "message": "upd"
        },
        {
          "sha": "eaf21effee7df5d1aba6912a4faa9b2e7483d06c",
          "message": "rename"
        },
        {
          "sha": "f7f998c7c15f72761638b3b7ef80868cc1845fda",
          "message": "upd"
        },
        {
          "sha": "fd162ff46273ab320e02759ef08cf4f471206715",
          "message": "cleanup"
        },
        {
          "sha": "0f7b2e70af5e17d4c1a453119f0e98797ce68fe7",
          "message": "Merge branch 'main' into fix_97923"
        }
      ],
      "comments": [
        {
          "user": "idegtiarenko",
          "body": "I am moving this to the test case specific to the list.\r\nThis is irrelevant to get task as it may or may not fork depending on the node receiving request and actually running the TEST_TASK"
        },
        {
          "user": "DaveCTurner",
          "body": "Hmm I don't follow this argument - doesn't the `storeResult == false` case have the same problem?"
        },
        {
          "user": "DaveCTurner",
          "body": "Could we do this with an `onTaskRegistered` listener rather than an `assertBusy()`?"
        },
        {
          "user": "idegtiarenko",
          "body": "Good point."
        },
        {
          "user": "idegtiarenko",
          "body": "I should have clarified it, this waits for the list task to start on all nodes, not the test task, so it is specific to the list test case."
        },
        {
          "user": "idegtiarenko",
          "body": "This does not really need assertBusy, moved it inside `waitForTestTaskStartOnAllNodes` that ensure task is both visible from list/get API after it have started on all nodes."
        }
      ],
      "body": "This change attempts to fix testListTasksWaitForCompletion by setting bariers to\r\n verify task started on all nodes and had a chance to list all running tasks\r\n before canceling the TEST_TASK\r\n\r\nCloses: #97923 ",
      "base_ref": "main",
      "head_ref": "fix_97923",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104391/comments"
    },
    {
      "number": 104389,
      "title": "Add logging to testRefreshingMultipleTimesWithinWindowSucceeds (#103613)",
      "state": "closed",
      "created_at": "2024-01-16T08:57:13Z",
      "updated_at": "2024-01-16T09:41:02Z",
      "closed_at": "2024-01-16T09:41:02Z",
      "merged_at": "2024-01-16T09:41:02Z",
      "author": "jfreden",
      "labels": [
        ">non-issue",
        ">test",
        ":Security/Security",
        "Team:Security",
        "v8.12.1"
      ],
      "comments_count": 1,
      "review_comments_count": 0,
      "additions": 7,
      "deletions": 3,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104389",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104389",
      "commits": [
        {
          "sha": "4c8af42e83e09ef79d892a4f967d49972ef9e369",
          "message": "Add logging to testRefreshingMultipleTimesWithinWindowSucceeds (#103613)"
        }
      ],
      "comments": [],
      "body": "Backport #103613",
      "base_ref": "8.12",
      "head_ref": "backport-ci-fix-auth-integ-test-812",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104389/comments"
    },
    {
      "number": 104388,
      "title": "Add logging to testRefreshingMultipleTimesWithinWindowSucceeds (#103613)",
      "state": "closed",
      "created_at": "2024-01-16T08:55:27Z",
      "updated_at": "2024-01-16T09:40:01Z",
      "closed_at": "2024-01-16T09:40:01Z",
      "merged_at": "2024-01-16T09:40:01Z",
      "author": "jfreden",
      "labels": [
        ">non-issue",
        ">test",
        ":Security/Security",
        "Team:Security",
        "v8.11.5"
      ],
      "comments_count": 1,
      "review_comments_count": 0,
      "additions": 7,
      "deletions": 3,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104388",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104388",
      "commits": [
        {
          "sha": "ec4f576a68e455dd3911aa7f01b3f03239c68267",
          "message": "Add logging to testRefreshingMultipleTimesWithinWindowSucceeds (#103613)"
        }
      ],
      "comments": [],
      "body": "Backport #103613",
      "base_ref": "8.11",
      "head_ref": "backport-ci-fix-auth-integ-test",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104388/comments"
    },
    {
      "number": 104377,
      "title": "Speedup testTasksWaitForAllTask",
      "state": "closed",
      "created_at": "2024-01-15T16:05:05Z",
      "updated_at": "2024-01-17T07:05:41Z",
      "closed_at": "2024-01-17T07:05:38Z",
      "merged_at": "2024-01-17T07:05:38Z",
      "author": "idegtiarenko",
      "labels": [
        ">test",
        ":Distributed Coordination/Task Management",
        "Team:Distributed (Obsolete)",
        "v8.13.0"
      ],
      "comments_count": 1,
      "review_comments_count": 0,
      "additions": 1,
      "deletions": 1,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104377",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104377",
      "commits": [
        {
          "sha": "712e5eedcfafa733791e10710fa0a971207c9f20",
          "message": "Speedup testTasksWaitForAllTask\n\nThis test relies on setWaitForCompletion expiring as task is always running. No\nneed to wait for it 10 seconds."
        }
      ],
      "comments": [],
      "body": "This test relies on testTasksWaitForAllTask expiring as task is always running. No need to wait for it 10 seconds.\r\n",
      "base_ref": "main",
      "head_ref": "speedup_test",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104377/comments"
    },
    {
      "number": 104375,
      "title": "[8.12] Fix ShardSplittingQueryTests by not using MockRandomMergePolicy for IndexWriter (#104358)",
      "state": "closed",
      "created_at": "2024-01-15T15:45:12Z",
      "updated_at": "2024-01-16T15:14:04Z",
      "closed_at": "2024-01-16T15:14:04Z",
      "merged_at": "2024-01-16T15:14:04Z",
      "author": "carlosdelest",
      "labels": [
        ">test",
        ":Search/Search",
        "backport",
        "Team:Search",
        "v8.12.1"
      ],
      "comments_count": 0,
      "review_comments_count": 0,
      "additions": 13,
      "deletions": 5,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104375",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104375",
      "commits": [
        {
          "sha": "556390a48e4b6784c66ca15d59801ec54e578a4d",
          "message": "Fix ShardSplittingQueryTests by not using MockRandomMergePolicy for IndexWriter (#104358)"
        }
      ],
      "comments": [],
      "body": "Backports the following commits to 8.12:\n - Fix ShardSplittingQueryTests by not using MockRandomMergePolicy for IndexWriter (#104358)",
      "base_ref": "8.12",
      "head_ref": "backport/8.12/pr-104358",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104375/comments"
    },
    {
      "number": 104374,
      "title": "Added more information to the \"deprecation\" log for `skip: feature`",
      "state": "closed",
      "created_at": "2024-01-15T15:43:38Z",
      "updated_at": "2024-01-31T11:32:25Z",
      "closed_at": "2024-01-29T08:47:19Z",
      "merged_at": null,
      "author": "ldematte",
      "labels": [
        ">test",
        ":Core/Infra/Core",
        "Team:Core/Infra",
        "v8.13.0"
      ],
      "comments_count": 5,
      "review_comments_count": 0,
      "additions": 34,
      "deletions": 30,
      "changed_files": 5,
      "url": "https://github.com/elastic/elasticsearch/pull/104374",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104374",
      "commits": [
        {
          "sha": "120c2107b04ff2745f054f2ec5f5131301a1ae8d",
          "message": "Added more information to the \"deprecation\" log for `skip: feature`"
        },
        {
          "sha": "d9bc44482081a85689e6fae31d6f88f8740432e7",
          "message": "Merge branch 'main' into better-skip-feature-deprecation-log"
        }
      ],
      "comments": [],
      "body": "The log we introduced in https://github.com/elastic/elasticsearch/pull/104140 to warn about the deprecation of `skip: features` in favour of the less ambiguous `requires: test_runner_features` is not very useful on a test suite with many files and/or many tests (it just repeats the same message over and over again).\r\n\r\nThis PR changes the log to include the test name and the section location, so the info can be used to track down the exact place where to update the test.\r\n\r\nFor the reviewers: should I include other information, like the file name (or the test suite name)?\r\nOr would it be better to keep the log message generic but include it just once per file/per test run?",
      "base_ref": "main",
      "head_ref": "better-skip-feature-deprecation-log",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104374/comments"
    },
    {
      "number": 104373,
      "title": "Fix CoreFullClusterRestartIT testRollover",
      "state": "closed",
      "created_at": "2024-01-15T15:36:41Z",
      "updated_at": "2024-01-16T15:54:21Z",
      "closed_at": "2024-01-16T15:54:18Z",
      "merged_at": "2024-01-16T15:54:17Z",
      "author": "joegallo",
      "labels": [
        ">test",
        ":Data Management/CAT APIs",
        "Team:Data Management",
        "v8.13.0"
      ],
      "comments_count": 1,
      "review_comments_count": 0,
      "additions": 7,
      "deletions": 4,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104373",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104373",
      "commits": [
        {
          "sha": "b80f45f72f043daccd310bd1bbc95762a4937814",
          "message": "Add an assertBusy to work around a bug"
        },
        {
          "sha": "88e902e503379dafe5dc893864ccf4c25901a4d5",
          "message": "Add a comment linking to the bug"
        },
        {
          "sha": "04cd9270fa2f6f38a383fe0871ffbd24ad667273",
          "message": "Include error_trace\n\nIn case some other bug should happen to come up sometime, it'd be nice\nto have the stack trace."
        }
      ],
      "comments": [],
      "body": "Closes #97809\r\n\r\n#104371 is the root issue here, and since the test in question isn't really primarily about testing the cat APIs specifically, I think it's fair to 'just' workaround the bug in the extremely rare case that it happens to come up.",
      "base_ref": "main",
      "head_ref": "fix-CoreFullClusterRestartIT-testRollover",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104373/comments"
    },
    {
      "number": 104372,
      "title": "Treat failed shard as no data in GetStatusActionIT",
      "state": "closed",
      "created_at": "2024-01-15T15:23:03Z",
      "updated_at": "2024-01-17T06:49:31Z",
      "closed_at": "2024-01-17T06:49:28Z",
      "merged_at": "2024-01-17T06:49:28Z",
      "author": "danielmitterdorfer",
      "labels": [
        ">test",
        ":UniversalProfiling/Application",
        "Team:obs-knowledge",
        "v8.13.0"
      ],
      "comments_count": 1,
      "review_comments_count": 0,
      "additions": 16,
      "deletions": 6,
      "changed_files": 3,
      "url": "https://github.com/elastic/elasticsearch/pull/104372",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104372",
      "commits": [
        {
          "sha": "f181534021491160d6dee2a54cb9c634e53e4a04",
          "message": "Treat failed shard as no data in GetStatusActionIT\n\nAmong other things, the profiling get status API checks whether a\ncluster contains any profiling-related data. It uses the search API for\nthat internally since #103920. However, shards might not ready shortly\nafter index creation and consequently that search request will fail.\n\nWith this commit we check whether a search phase has failed and treat\nthis as if the cluster contains no profiling-related data.\n\nCloses #104035"
        },
        {
          "sha": "87cef39ef2142572224db1ffe9fc11ee7508114b",
          "message": "Reenable another test affected by this root cause"
        },
        {
          "sha": "79563d401d553748ba97ad771edfe7ee341bb317",
          "message": "Remove obsolete import"
        }
      ],
      "comments": [],
      "body": "Among other things, the profiling get status API checks whether a cluster contains any profiling-related data. It uses the search API for that internally since #103920. However, shards might not be ready shortly after index creation and consequently that search request will fail.\r\n\r\nWith this commit we check whether a search phase has failed and treat this as if the cluster contains no profiling-related data.\r\n\r\nCloses #104035\r\nCloses #104038",
      "base_ref": "main",
      "head_ref": "profiling-status-test",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104372/comments"
    },
    {
      "number": 104370,
      "title": "[ML] Detect timeout when waiting for download task (#103197)",
      "state": "closed",
      "created_at": "2024-01-15T14:56:32Z",
      "updated_at": "2024-01-15T15:44:57Z",
      "closed_at": "2024-01-15T15:44:34Z",
      "merged_at": "2024-01-15T15:44:34Z",
      "author": "davidkyle",
      "labels": [
        ">test",
        ":ml",
        "backport",
        "auto-merge-without-approval",
        "v8.12.1"
      ],
      "comments_count": 0,
      "review_comments_count": 0,
      "additions": 119,
      "deletions": 39,
      "changed_files": 7,
      "url": "https://github.com/elastic/elasticsearch/pull/104370",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104370",
      "commits": [
        {
          "sha": "8578dce17ecb0434d67fe05e5172cad129d6f96c",
          "message": "[ML] Detect timeout when waiting for download task (#103197)\n\nA list tasks timeout indicates the task exists and is in progress.\nInterpreting the timeout as the task not existing meant the download\ncheck would incorrectly assume the download had completed.\n# Conflicts:\n#\tx-pack/plugin/ml-package-loader/src/main/java/org/elasticsearch/xpack/ml/packageloader/action/TransportLoadTrainedModelPackage.java\n#\tx-pack/plugin/src/yamlRestTest/resources/rest-api-spec/test/ml/3rd_party_deployment.yml"
        }
      ],
      "comments": [],
      "body": "A list tasks timeout indicates the task exists and is in progress. Interpreting the timeout as the task not existing meant the download check would incorrectly assume the download had completed.\r\n\r\nbackport of #103197",
      "base_ref": "8.12",
      "head_ref": "waiting-on-download-812",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104370/comments"
    },
    {
      "number": 104366,
      "title": "Account for shard count in profiling test timeout",
      "state": "closed",
      "created_at": "2024-01-15T13:15:00Z",
      "updated_at": "2024-01-16T14:06:48Z",
      "closed_at": "2024-01-16T14:06:45Z",
      "merged_at": "2024-01-16T14:06:45Z",
      "author": "danielmitterdorfer",
      "labels": [
        ">test",
        ":UniversalProfiling/Application",
        "Team:obs-knowledge",
        "v8.13.0"
      ],
      "comments_count": 1,
      "review_comments_count": 0,
      "additions": 3,
      "deletions": 8,
      "changed_files": 4,
      "url": "https://github.com/elastic/elasticsearch/pull/104366",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104366",
      "commits": [
        {
          "sha": "8379b21cd6963feb51385b7c5c65e70caba1096b",
          "message": "Account for shard count in profiling test timeout\n\nWith this commit we increase the timeout to wait for a green cluster\nstate in the integration tests for the profiling plugin. We do this\nbecause the tests create all profiling-related indices with more shards\nthan usual and that might take longer than usual until the cluster is\ngreen.\n\nCloses #103809"
        }
      ],
      "comments": [],
      "body": "With this commit we increase the timeout to wait for a green cluster state in the integration tests for the profiling plugin. We do this because the tests create all profiling-related indices with more shards than usual and that might take longer than usual until the cluster is green.\r\n\r\nCloses #103809",
      "base_ref": "main",
      "head_ref": "profiling-tests",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104366/comments"
    },
    {
      "number": 104358,
      "title": "Fix ShardSplittingQueryTests by not using MockRandomMergePolicy for IndexWriter",
      "state": "closed",
      "created_at": "2024-01-15T09:27:22Z",
      "updated_at": "2024-01-15T15:45:27Z",
      "closed_at": "2024-01-15T15:44:05Z",
      "merged_at": "2024-01-15T15:44:05Z",
      "author": "carlosdelest",
      "labels": [
        ">test",
        ":Search/Search",
        "Team:Search",
        "auto-backport",
        "v8.12.0",
        "v8.12.1",
        "v8.13.0"
      ],
      "comments_count": 2,
      "review_comments_count": 0,
      "additions": 13,
      "deletions": 5,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104358",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104358",
      "commits": [
        {
          "sha": "1c2f3869ee86772661cabd46b65c0332d1668803",
          "message": "Fix ShardSplittingQueryTests by not using MockRandomMergePolicy for the IndexWriter"
        },
        {
          "sha": "c96b307978790755d8312fb35af95dacd98b8f3c",
          "message": "Merge remote-tracking branch 'origin/main' into carlosdelest/fix/fix-shard-splitting-query-tests"
        },
        {
          "sha": "6757ec47739488f383e5a067431b8ff1b516dd08",
          "message": "Remove AwaitsFix"
        }
      ],
      "comments": [],
      "body": "This test relies on docIDs being in order. Using a random merge policy makes that assumption false.\r\n\r\nWe disable the use of MockRandomMergePolicy for these tests so we ensure the doc ID check is valid.\r\n\r\nFixes https://github.com/elastic/elasticsearch/issues/104111\r\nFixes https://github.com/elastic/elasticsearch/issues/104349\r\n",
      "base_ref": "main",
      "head_ref": "carlosdelest/fix/fix-shard-splitting-query-tests",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104358/comments"
    },
    {
      "number": 104340,
      "title": "ESQL: Fix error test on windows",
      "state": "closed",
      "created_at": "2024-01-12T19:52:46Z",
      "updated_at": "2024-01-12T20:36:37Z",
      "closed_at": "2024-01-12T20:36:14Z",
      "merged_at": "2024-01-12T20:36:14Z",
      "author": "nik9000",
      "labels": [
        ">test",
        "Team:Analytics",
        "auto-merge-without-approval",
        ":Analytics/ES|QL",
        "v8.13.0"
      ],
      "comments_count": 1,
      "review_comments_count": 0,
      "additions": 11,
      "deletions": 3,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104340",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104340",
      "commits": [
        {
          "sha": "7076056001beb347058c7f9d99350962d3d98013",
          "message": "ESQL: Fix error test on windows\n\nThis fixes a test on windows - the error message contains the platform\nlocal line endings because it comes from the jvm.\n\nCloses #104296"
        }
      ],
      "comments": [],
      "body": "This fixes a test on windows - the error message contains the platform local line endings because it comes from the jvm.\r\n\r\nCloses #104296\r\nCloses #104245\r\n",
      "base_ref": "main",
      "head_ref": "fix_windows_test",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104340/comments"
    },
    {
      "number": 104336,
      "title": "Fix request timeout in HeapAttack tests",
      "state": "closed",
      "created_at": "2024-01-12T18:42:35Z",
      "updated_at": "2024-01-22T19:27:41Z",
      "closed_at": "2024-01-22T19:27:40Z",
      "merged_at": "2024-01-22T19:27:40Z",
      "author": "dnhatn",
      "labels": [
        ">test",
        "Team:Analytics",
        ":Analytics/ES|QL",
        "v8.13.0"
      ],
      "comments_count": 3,
      "review_comments_count": 0,
      "additions": 5,
      "deletions": 1,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104336",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104336",
      "commits": [
        {
          "sha": "83181834ecf2ace279b4ab8ad277a621b65db906",
          "message": "Fix request timeout in HeapAttack tests"
        }
      ],
      "comments": [],
      "body": "I noticed we're using 5 minutes for both query timeout and triggering the out-of-memory action in heap attack tests. This means when we're generating the heap dump, and some ESQL tasks might get canceled because the connection was disconnected. This PR increases the query timeout to 6 minutes instead.",
      "base_ref": "main",
      "head_ref": "fix-timeout-heap-attack",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104336/comments"
    },
    {
      "number": 104333,
      "title": "ESQL: Fix old version tests",
      "state": "closed",
      "created_at": "2024-01-12T17:48:05Z",
      "updated_at": "2024-01-12T20:38:15Z",
      "closed_at": "2024-01-12T20:37:52Z",
      "merged_at": "2024-01-12T20:37:52Z",
      "author": "nik9000",
      "labels": [
        ">test",
        "Team:Analytics",
        "auto-merge-without-approval",
        "test-full-bwc",
        ":Analytics/ES|QL",
        "v8.13.0"
      ],
      "comments_count": 2,
      "review_comments_count": 0,
      "additions": 5,
      "deletions": 6,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104333",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104333",
      "commits": [
        {
          "sha": "c081909fb39fe5f1752bb67cf2d120b7d556b765",
          "message": "ESQL: Fix old version tests\n\nThis weakens an assertion in the ESQL tests rolling upgrade tests so\nthey'll pass against older versions of Elasticsearch. Apparently the\nwarning message changed. There isn't a good reason to be so strict about\nthe assertion anyway."
        },
        {
          "sha": "c34dbe87e61a91e135cdbe10be52d75f92e8b322",
          "message": "Checkstyle"
        }
      ],
      "comments": [],
      "body": "This weakens an assertion in the ESQL tests rolling upgrade tests so they'll pass against older versions of Elasticsearch. Apparently the warning message changed. There isn't a good reason to be so strict about the assertion anyway.\r\n\r\nCloses #104101",
      "base_ref": "main",
      "head_ref": "esql_weaken_assetion",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104333/comments"
    },
    {
      "number": 104331,
      "title": "Simplify the int8_hnsw MIP yaml test",
      "state": "closed",
      "created_at": "2024-01-12T17:04:45Z",
      "updated_at": "2024-01-16T13:08:57Z",
      "closed_at": "2024-01-16T13:07:12Z",
      "merged_at": "2024-01-16T13:07:12Z",
      "author": "benwtrent",
      "labels": [
        ">test",
        "Team:Search",
        "auto-merge-without-approval",
        ":Search Relevance/Vectors",
        "v8.12.1",
        "v8.13.0"
      ],
      "comments_count": 3,
      "review_comments_count": 0,
      "additions": 5,
      "deletions": 5,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104331",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104331",
      "commits": [
        {
          "sha": "cceea441529e401d53ce678da6a289745ec439be",
          "message": "Simplify the int8_hnsw MIP yaml test"
        },
        {
          "sha": "73afb9f69e22c27a2a6bc096d416a7148a81daf0",
          "message": "Merge branch 'main' into test/simplify-byte-mip-test"
        }
      ],
      "comments": [],
      "body": "The test is unnecessarily complicated with its vectors. This simplifies the vectors and the test. We mainly care about extreme weirdness & server level failures.\r\n\r\ncloses: https://github.com/elastic/elasticsearch/issues/104297",
      "base_ref": "main",
      "head_ref": "test/simplify-byte-mip-test",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104331/comments"
    },
    {
      "number": 104330,
      "title": "ESQL: Run async tests more carefully",
      "state": "closed",
      "created_at": "2024-01-12T17:01:03Z",
      "updated_at": "2024-01-12T17:48:52Z",
      "closed_at": "2024-01-12T17:48:29Z",
      "merged_at": "2024-01-12T17:48:29Z",
      "author": "nik9000",
      "labels": [
        ">test",
        "Team:Analytics",
        "auto-merge-without-approval",
        ":Analytics/ES|QL",
        "v8.13.0"
      ],
      "comments_count": 2,
      "review_comments_count": 0,
      "additions": 133,
      "deletions": 79,
      "changed_files": 4,
      "url": "https://github.com/elastic/elasticsearch/pull/104330",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104330",
      "commits": [
        {
          "sha": "793c76f3e3a073399b4ed329cd0b351af60684c5",
          "message": "ESQL: Run async tests more carefully\n\nThe ESQL async tests run the ESQL yaml tests two extra time - once under\nthe async endpoint with the `wait_for_completion_timeout` set to a long\ntime and *again* with `wait_for_completion_timeout` set to a short time,\nexpecting to receive an `id` for the query.\n\nThat second way is tricky! Even with a `0ms` timeout sometimes the\nrequest will complete. That's great, but the tests didn't realize that\nwas possible. And it's tricky to get the warnings and `catch` sections\nworking properly with that. This reworks how we run these commands,\nbreaking apart the way we run a single API and running it as two, taking\ninto account that the \"start the query\" request could also complete the\nquery.\n\nCloses #104294"
        }
      ],
      "comments": [],
      "body": "The ESQL async tests run the ESQL yaml tests two extra time - once under the async endpoint with the `wait_for_completion_timeout` set to a long time and *again* with `wait_for_completion_timeout` set to a short time, expecting to receive an `id` for the query.\r\n\r\nThat second way is tricky! Even with a `0ms` timeout sometimes the request will complete. That's great, but the tests didn't realize that was possible. And it's tricky to get the warnings and `catch` sections working properly with that. This reworks how we run these commands, breaking apart the way we run a single API and running it as two, taking into account that the \"start the query\" request could also complete the query.\r\n\r\nCloses #104294\r\n",
      "base_ref": "main",
      "head_ref": "esql_asynk_run_harder",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104330/comments"
    },
    {
      "number": 104329,
      "title": "Re-enabling MultiNodesStatsTests.testMultipleNodes()",
      "state": "closed",
      "created_at": "2024-01-12T16:54:20Z",
      "updated_at": "2024-01-12T17:40:59Z",
      "closed_at": "2024-01-12T17:40:55Z",
      "merged_at": "2024-01-12T17:40:55Z",
      "author": "masseyke",
      "labels": [
        ">test",
        ":Data Management/Monitoring",
        "Team:Data Management",
        "v8.13.0"
      ],
      "comments_count": 1,
      "review_comments_count": 0,
      "additions": 0,
      "deletions": 1,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104329",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104329",
      "commits": [
        {
          "sha": "3ad57a3ba245306fc2bc6eba5cec41037234828c",
          "message": "Re-enabling MultiNodesStatsTests.testMultipleNodes()"
        }
      ],
      "comments": [],
      "body": "Re-enabling MultiNodesStatsTests.testMultipleNodes() to see if it is still broken.\r\nThis was reported broken in #96374.",
      "base_ref": "main",
      "head_ref": "re-enable-MultiNodesStatsTests",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104329/comments"
    },
    {
      "number": 104328,
      "title": "Fail fast on heap attack tests",
      "state": "closed",
      "created_at": "2024-01-12T16:42:41Z",
      "updated_at": "2024-01-12T17:39:33Z",
      "closed_at": "2024-01-12T17:39:32Z",
      "merged_at": "2024-01-12T17:39:32Z",
      "author": "dnhatn",
      "labels": [
        ">test",
        "Team:Analytics",
        ":Analytics/ES|QL",
        "v8.13.0"
      ],
      "comments_count": 2,
      "review_comments_count": 0,
      "additions": 8,
      "deletions": 1,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104328",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104328",
      "commits": [
        {
          "sha": "516d9fda504e6d43409e495328eae0d8b075a1b3",
          "message": "Fail fast on heap attack tests"
        }
      ],
      "comments": [],
      "body": "We can't use `assume` after a test fails.",
      "base_ref": "main",
      "head_ref": "heap-attack-abort",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104328/comments"
    },
    {
      "number": 104321,
      "title": "[TEST] Use delta for comparing doubles in testEncodeDecodeNoSaturation",
      "state": "closed",
      "created_at": "2024-01-12T15:25:38Z",
      "updated_at": "2024-01-15T13:23:22Z",
      "closed_at": "2024-01-15T13:22:59Z",
      "merged_at": "2024-01-15T13:22:59Z",
      "author": "kkrik-es",
      "labels": [
        ">test",
        "auto-merge-without-approval",
        ":StorageEngine/TSDB",
        "v8.13.0",
        "Team:StorageEngine"
      ],
      "comments_count": 1,
      "review_comments_count": 0,
      "additions": 5,
      "deletions": 1,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104321",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104321",
      "commits": [
        {
          "sha": "287a50e3e5b2ba3bd977d1a2a965e0e845ce2b77",
          "message": "Use delta for comparing doubles in testEncodeDecodeNoSaturation"
        }
      ],
      "comments": [],
      "body": "Fixes #103924\r\n",
      "base_ref": "main",
      "head_ref": "fix/103924",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104321/comments"
    },
    {
      "number": 104302,
      "title": "[Transform] Fix and unmute transform chaining test.",
      "state": "closed",
      "created_at": "2024-01-12T10:06:03Z",
      "updated_at": "2024-01-16T11:04:54Z",
      "closed_at": "2024-01-16T11:04:51Z",
      "merged_at": "2024-01-16T11:04:50Z",
      "author": "przemekwitek",
      "labels": [
        ">test",
        ":ml/Transform",
        "Team:ML",
        "v8.13.0"
      ],
      "comments_count": 3,
      "review_comments_count": 2,
      "additions": 136,
      "deletions": 42,
      "changed_files": 3,
      "url": "https://github.com/elastic/elasticsearch/pull/104302",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104302",
      "commits": [
        {
          "sha": "fa33b463212f1cbacee95d3c6c1312dce695fdbd",
          "message": "[Transform] Fix and unmute transform chaining test."
        },
        {
          "sha": "bc67f015efe522c3a171dcdbc969dab754d0cae5",
          "message": "Merge branch 'main' into unmute_chaining_test"
        },
        {
          "sha": "1fb4670afda1c5f602e315dd6fe9c45d6b373e18",
          "message": "Fix chaining test: add event.ingested pipeline"
        },
        {
          "sha": "812a18028c2b9cc179e904b6b5c1237d2cb4e120",
          "message": "Fix forbiddenApisJavaRestTest"
        },
        {
          "sha": "b2ef2af845b5d482332828dd29454c52d15a19d7",
          "message": "Increase timeout"
        },
        {
          "sha": "23c788ad404a7bd3c47e38f36807c5ae794a51e9",
          "message": "Apply review comments."
        }
      ],
      "comments": [
        {
          "user": "droberts195",
          "body": "I think this method should be renamed to something like `setup`, or, if that clashes with a base class method, then `setupTransformTests` or something like that. It does much more than create a thread pool now."
        },
        {
          "user": "przemekwitek",
          "body": "Done."
        }
      ],
      "body": "This PR:\r\n1. fixes and unmutes `TransformChainIT.testChainedTransforms` test\r\n2. adds `TransformGetCheckpointIT.testGetCheckpointWithMissingIndex` test\r\n\r\nRelates https://github.com/elastic/elasticsearch/issues/103678\r\nCloses https://github.com/elastic/elasticsearch/issues/104238",
      "base_ref": "main",
      "head_ref": "unmute_chaining_test",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104302/comments"
    },
    {
      "number": 104301,
      "title": "[8.12] [Test] Remove mocker appender before closing it (#104300)",
      "state": "closed",
      "created_at": "2024-01-12T08:30:15Z",
      "updated_at": "2024-01-12T09:15:04Z",
      "closed_at": "2024-01-12T09:14:41Z",
      "merged_at": "2024-01-12T09:14:41Z",
      "author": "ywangd",
      "labels": [
        ">test",
        ":Distributed Coordination/Network",
        "backport",
        "Team:Distributed (Obsolete)",
        "auto-merge-without-approval",
        "v8.12.1"
      ],
      "comments_count": 0,
      "review_comments_count": 0,
      "additions": 1,
      "deletions": 1,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104301",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104301",
      "commits": [
        {
          "sha": "f7515200bbdab56ac9a7fcc02d93f434ec122516",
          "message": "[Test] Remove mocker appender before closing it (#104300)\n\nThe appender must be removed first before closing. Otherwise, the test\nsometimes tries to log additional messages when the appender is closed.\n\nResolves: #103782"
        }
      ],
      "comments": [],
      "body": "Backports the following commits to 8.12:\n - [Test] Remove mocker appender before closing it (#104300)",
      "base_ref": "8.12",
      "head_ref": "backport/8.12/pr-104300",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104301/comments"
    },
    {
      "number": 104300,
      "title": "[Test] Remove mocker appender before closing it",
      "state": "closed",
      "created_at": "2024-01-12T07:42:03Z",
      "updated_at": "2024-01-12T08:30:26Z",
      "closed_at": "2024-01-12T08:28:16Z",
      "merged_at": "2024-01-12T08:28:16Z",
      "author": "ywangd",
      "labels": [
        ">test",
        ":Distributed Coordination/Network",
        "Team:Distributed (Obsolete)",
        "auto-merge-without-approval",
        "v8.12.0",
        "v8.13.0"
      ],
      "comments_count": 2,
      "review_comments_count": 0,
      "additions": 1,
      "deletions": 2,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104300",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104300",
      "commits": [
        {
          "sha": "7fb1959e427fd8ad1c1080e0107fb17b963a2465",
          "message": "[Test] Remove mocker appender before closing it\n\nThe appender must be removed first before closing. Otherwise, the test\nsometimes tries to log additional messages when the appender is closed.\n\nResolves: #103782"
        }
      ],
      "comments": [],
      "body": "The appender must be removed first before closing. Otherwise, the test sometimes tries to log additional messages when the appender is closed.\r\n\r\nResolves: #103782\r\n",
      "base_ref": "main",
      "head_ref": "es-103782-remove-before-close-appender",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104300/comments"
    },
    {
      "number": 104299,
      "title": "Fix: remove wrong assertion from `ESRestTestFeatureService#clusterHasFeature`",
      "state": "closed",
      "created_at": "2024-01-12T07:29:46Z",
      "updated_at": "2024-01-12T10:07:23Z",
      "closed_at": "2024-01-12T10:07:18Z",
      "merged_at": "2024-01-12T10:07:18Z",
      "author": "ldematte",
      "labels": [
        ">test",
        ":Core/Infra/Core",
        "Team:Core/Infra",
        "v8.13.0"
      ],
      "comments_count": 2,
      "review_comments_count": 0,
      "additions": 24,
      "deletions": 28,
      "changed_files": 2,
      "url": "https://github.com/elastic/elasticsearch/pull/104299",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104299",
      "commits": [
        {
          "sha": "994ef6c23f48a72a70da9202cafe8db00d847c2c",
          "message": "Fix: removed wrong assertion in ESRestTestFeatureService#clusterHasFeature\n\nThe check is currently broken - feature check always falls back to historical features, and only then if the feature is not one of the historical ones, and exception (assert) is risen.\nThis is wrong: it could be that we are testing for a non-historical feature, and the cluster simply does not have it.\n\nThe check could be fixed with https://github.com/elastic/elasticsearch/pull/104257, but we decided it has little advantage over the complexity it brings - better remove it."
        },
        {
          "sha": "749f3ac6d3878d47c85852f83d297304bf1e9e94",
          "message": "Checkstyle + SuppressForbidden"
        }
      ],
      "comments": [],
      "body": "The check is currently broken - feature check always falls back to historical features, and only then if the feature is not one of the historical ones, and exception (assert) is risen.\r\nThis is wrong: it could be that we are testing for a non-historical feature, and the cluster under test simply does not have it.\r\n\r\nThe check could be fixed with https://github.com/elastic/elasticsearch/pull/104257, but we decided it has little advantage over the complexity it brings - better remove it.",
      "base_ref": "main",
      "head_ref": "remove-test-service-feature-name-check",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104299/comments"
    },
    {
      "number": 104279,
      "title": "Add checks for old cluster features in rolling upgrade tests",
      "state": "closed",
      "created_at": "2024-01-11T17:05:03Z",
      "updated_at": "2024-01-17T13:37:23Z",
      "closed_at": "2024-01-17T13:37:17Z",
      "merged_at": "2024-01-17T13:37:17Z",
      "author": "ldematte",
      "labels": [
        ">test",
        ":Core/Infra/Core",
        "Team:Core/Infra",
        "test-full-bwc",
        "v8.13.0"
      ],
      "comments_count": 4,
      "review_comments_count": 5,
      "additions": 139,
      "deletions": 42,
      "changed_files": 14,
      "url": "https://github.com/elastic/elasticsearch/pull/104279",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104279",
      "commits": [
        {
          "sha": "905c21270f4ddbe43059fe9f283f9779d4a4b202",
          "message": "Add checks for old cluster features in rolling upgrade tests\n\nAdd the ability to test for the original/old cluster features during a rolling upgrade"
        },
        {
          "sha": "9fa52df181d691ef28a75926394f0cb5adab906d",
          "message": "Merge branch 'main' into old-cluster-features"
        },
        {
          "sha": "0a9566d04772d8007084ac2fb739b0c9e1c7d254",
          "message": "Spotless + more versions replaced"
        },
        {
          "sha": "4e7591be0ae625ec957b494a629ee16e29f264f1",
          "message": "Merge branch 'old-cluster-features' of github.com:ldematte/elasticsearch into old-cluster-features"
        },
        {
          "sha": "f6f53cd54bf26cfe29bb45121d3f6f925bb0971c",
          "message": "Merge remote-tracking branch 'upstream/main' into old-cluster-features"
        },
        {
          "sha": "0c08ba2f747375682f3c0d316d283198f50da1bf",
          "message": "Fixes"
        },
        {
          "sha": "7cf7ee62097382c7516afb11ff439775ee7841df",
          "message": "More versions to features"
        },
        {
          "sha": "4e37a883bcdc8ca83dc31ced1f47023ae7456923",
          "message": "Merge remote-tracking branch 'upstream/main' into old-cluster-features"
        },
        {
          "sha": "04c6fbd764ef1878f6077d8b7554acea83125ff8",
          "message": "Moving ALL_FEATURES to ESRestTestCase (and make it private - only usage)"
        }
      ],
      "comments": [
        {
          "user": "thecoop",
          "body": "The clear is an `AfterClass`. So should this be `BeforeClass`?"
        },
        {
          "user": "thecoop",
          "body": "Does it make sense to have this defined here, now the interface is more complicated? It's only used in ESRestTestCase, and the implementation of `getAllSupportedFeatures` references its use. So I think this should instead be the initial instance of `ESRestTestCase.testFeatureService`"
        },
        {
          "user": "ldematte",
          "body": "That's a good point; I'll move it there."
        },
        {
          "user": "ldematte",
          "body": "It cannot be in `BeforeClass`, as it needs `testFeatureService` to be initialized - which for reasons happens in a `Before` method in the base class.\r\nBesides, it follows the same pattern as the other initialization functions in the test, like `extractOldIndexVersion`.\r\nMy understanding is that everything is initialized in `Before` (keeping track of the upgrade \"phase\"), and when only when all tests from all phases are done we cleanup (that's why `AfterClass`)"
        },
        {
          "user": "ldematte",
          "body": "I was also wondering if I should rename it to something like `UNINITIALIZED`, but decided to leave it as-is for now"
        }
      ],
      "body": "Add the ability to test for the original/old cluster features during a rolling upgrade",
      "base_ref": "main",
      "head_ref": "old-cluster-features",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104279/comments"
    },
    {
      "number": 104274,
      "title": "Add comma escape character",
      "state": "closed",
      "created_at": "2024-01-11T15:58:28Z",
      "updated_at": "2024-01-16T14:58:07Z",
      "closed_at": "2024-01-16T14:50:36Z",
      "merged_at": "2024-01-16T14:50:36Z",
      "author": "astefan",
      "labels": [
        ">enhancement",
        ">test",
        "Team:Analytics",
        ":Analytics/ES|QL",
        "v8.13.0"
      ],
      "comments_count": 3,
      "review_comments_count": 2,
      "additions": 93,
      "deletions": 22,
      "changed_files": 2,
      "url": "https://github.com/elastic/elasticsearch/pull/104274",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104274",
      "commits": [
        {
          "sha": "b1ee21827eea886b63f260421638ccf62aa85373",
          "message": "Add escape character for comma in CsvTestsDataLoader"
        },
        {
          "sha": "6a485176e592e1f6a0f59ecdb60a9712d10467ac",
          "message": "Merge branch 'main' of https://github.com/elastic/elasticsearch into add_comma_escape_csvtestloader"
        },
        {
          "sha": "7013afeb05087fbd55f6ee61c425641d1b1fa556",
          "message": "Handle escaped commas in .csv-spec values as well"
        },
        {
          "sha": "37c1f6c674e06e48d17a582a69957a77a5e2d029",
          "message": "Merge branch 'main' of https://github.com/elastic/elasticsearch into add_comma_escape_csvtestloader"
        },
        {
          "sha": "f9d92a1186845478f2c90c5c6ccb88c9491104ff",
          "message": "Merge branch 'main' of https://github.com/elastic/elasticsearch into add_comma_escape_csvtestloader"
        },
        {
          "sha": "2a5302da29d34e2abe74ca7ab060c1e53b21ee54",
          "message": "Fix"
        },
        {
          "sha": "beb1c6c80162e9758abc5d477c0a1198baf0ee6c",
          "message": "Small fix"
        },
        {
          "sha": "924753adead1eb5b4be9da87aa83b07ba80debb0",
          "message": "Merge branch 'main' of https://github.com/elastic/elasticsearch into add_comma_escape_csvtestloader"
        },
        {
          "sha": "4e7c76085c5a50be69fb20db6aeba8212e0207a2",
          "message": "Polish"
        },
        {
          "sha": "e9fe3c1e0727e36154d5f83126a3e6fb8ce32264",
          "message": "Merge branch 'main' of https://github.com/elastic/elasticsearch into add_comma_escape_csvtestloader"
        },
        {
          "sha": "9429e16b246df57eaa5587ed5d6fd84accd3f0b2",
          "message": "More comments"
        }
      ],
      "comments": [
        {
          "user": "astefan",
          "body": "This change comes as a consequence of `main` method not working anymore because of `Exception in thread \"main\" java.security.AccessControlException: access denied (\"org.elasticsearch.secure_sm.ThreadPermission\" \"modifyArbitraryThreadGroup\")`. The `main` doesn't work being executed from within IDE (run from gradle or as a Java class) or outside of it with gradle. The exception comes from randomization code inside Lucene\r\n\r\n```\r\n\tat org.apache.lucene.tests.util.LuceneTestCase.random(LuceneTestCase.java:800)\r\n\tat org.elasticsearch.test.ESTestCase.randomFrom(ESTestCase.java:1003)\r\n\tat org.elasticsearch.test.rest.ESRestTestCase.randomSupportedContentType(ESRestTestCase.java:2409)\r\n\tat org.elasticsearch.test.rest.ESRestTestCase.addXContentBody(ESRestTestCase.java:2413)\r\n\tat org.elasticsearch.test.rest.ESRestTestCase.newXContentRequest(ESRestTestCase.java:2426)\r\n\tat org.elasticsearch.test.rest.ESRestTestCase.createIndex(ESRestTestCase.java:1709)\r\n```"
        },
        {
          "user": "bpintea",
          "body": "👍 "
        }
      ],
      "body": "Add an escape character for CSV loading.\r\nChange the way indices are created when CsvTestsDataLoader is executed standalone as \"main\" class.",
      "base_ref": "main",
      "head_ref": "add_comma_escape_csvtestloader",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104274/comments"
    },
    {
      "number": 104272,
      "title": "ESQL: Harden async tests",
      "state": "closed",
      "created_at": "2024-01-11T15:55:43Z",
      "updated_at": "2024-01-11T16:37:12Z",
      "closed_at": "2024-01-11T16:36:49Z",
      "merged_at": "2024-01-11T16:36:49Z",
      "author": "nik9000",
      "labels": [
        ">test",
        "Team:Analytics",
        "auto-merge-without-approval",
        ":Analytics/ES|QL",
        "v8.13.0"
      ],
      "comments_count": 1,
      "review_comments_count": 0,
      "additions": 1,
      "deletions": 0,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104272",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104272",
      "commits": [
        {
          "sha": "0906d80ba4ce78568b446b08b22e60783d04d324",
          "message": "ESQL: Harden asyn tests\n\nI've seen errors in the async tests where they expect to return an `id`\nbut the results come back too fast! Well, this forces us to return the\n`id` even if we have the results. Then the test can happily fetch by the\n`id` every time.\n\nCloses #104251"
        }
      ],
      "comments": [],
      "body": "I've seen errors in the async tests where they expect to return an `id` but the results come back too fast! Well, this forces us to return the `id` even if we have the results. Then the test can happily fetch by the `id` every time.\r\n\r\nCloses #104251\r\n",
      "base_ref": "main",
      "head_ref": "esql_async_test_keep",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104272/comments"
    },
    {
      "number": 104267,
      "title": "ESQL: Test all operators with breaker",
      "state": "closed",
      "created_at": "2024-01-11T14:51:56Z",
      "updated_at": "2024-01-12T12:58:12Z",
      "closed_at": "2024-01-12T12:58:00Z",
      "merged_at": "2024-01-12T12:58:00Z",
      "author": "nik9000",
      "labels": [
        ">test",
        "Team:Analytics",
        ":Analytics/ES|QL",
        "v8.13.0"
      ],
      "comments_count": 2,
      "review_comments_count": 0,
      "additions": 23,
      "deletions": 41,
      "changed_files": 5,
      "url": "https://github.com/elastic/elasticsearch/pull/104267",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104267",
      "commits": [
        {
          "sha": "a892f3cd685eecb7befd1bde82b9b1e078137da6",
          "message": "ESQL: Test all operators with breaker\n\nThis modifies the operator tests to *always* test with a breaker without\nthe ability to opt out. Previously three operations opted out:\n1. mv_expand never through exceptions even though it should. It was\n   using the block factory of the test blocks which didn't have a\n   breaker. I modified the test blocks to take a breaker so now it\n   properly breaks.\n2. reading values was throwing strange exceptions when I first wrote\n   these tests and I didn't have time to get it work. I don't 100%\n   recall what those exceptions were but they seem to be gone now. Good\n   fairies?\n3. The \"project\" operator doesn't allocate much of anything - it just\n   drops or shifts block around. But the work I did to move the test\n   blocks under the limit makes it so the test itself can throw. That's\n   good enough for this."
        }
      ],
      "comments": [],
      "body": "This modifies the operator tests to *always* test with a breaker without the ability to opt out. Previously three operations opted out:\r\n1. mv_expand never through exceptions even though it should. It was using the block factory of the test blocks which didn't have a breaker. I modified the test blocks to take a breaker so now it properly breaks.\r\n2. reading values was throwing strange exceptions when I first wrote these tests and I didn't have time to get it work. I don't 100% recall what those exceptions were but they seem to be gone now. Good fairies?\r\n3. The \"project\" operator doesn't allocate much of anything - it just drops or shifts block around. But the work I did to move the test blocks under the limit makes it so the test itself can throw. That's good enough for this.\r\n",
      "base_ref": "main",
      "head_ref": "esql_remaining_breakers",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104267/comments"
    },
    {
      "number": 104258,
      "title": "Encapsulate recoverLocallyUpToGlobalCheckpoint in tests",
      "state": "closed",
      "created_at": "2024-01-11T11:54:03Z",
      "updated_at": "2024-06-17T06:17:24Z",
      "closed_at": "2024-01-11T12:47:00Z",
      "merged_at": "2024-01-11T12:47:00Z",
      "author": "DaveCTurner",
      "labels": [
        ">test",
        ":Distributed Indexing/Recovery",
        "Team:Distributed (Obsolete)",
        "auto-merge-without-approval",
        "v8.13.0"
      ],
      "comments_count": 1,
      "review_comments_count": 0,
      "additions": 13,
      "deletions": 9,
      "changed_files": 3,
      "url": "https://github.com/elastic/elasticsearch/pull/104258",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104258",
      "commits": [
        {
          "sha": "3804e809e22fbe027e9ad1f200889f481ce76bba",
          "message": "Encapsulate recoverLocallyUpToGlobalCheckpoint in tests\n\nWe call `IndexShard#recoverLocallyUpToGlobalCheckpoint` in a synchronous\nway in various tests. This commit encapsulates all these calls in a\nutility method so that we can adapt it into an async API without masses\nof noise."
        }
      ],
      "comments": [],
      "body": "We call `IndexShard#recoverLocallyUpToGlobalCheckpoint` in a synchronous\r\nway in various tests. This commit encapsulates all these calls in a\r\nutility method so that we can adapt it into an async API without masses\r\nof noise.",
      "base_ref": "main",
      "head_ref": "2024/01/11/encapsulate-test-recoverLocallyUpToGlobalCheckpoint",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104258/comments"
    },
    {
      "number": 104257,
      "title": "Add names of \"regular\" cluster features to extracted feature metadata",
      "state": "closed",
      "created_at": "2024-01-11T11:51:22Z",
      "updated_at": "2024-01-11T15:09:09Z",
      "closed_at": "2024-01-11T15:09:09Z",
      "merged_at": null,
      "author": "ldematte",
      "labels": [
        ">test",
        ":Core/Infra/Core",
        "Team:Core/Infra",
        "v8.13.0"
      ],
      "comments_count": 3,
      "review_comments_count": 7,
      "additions": 194,
      "deletions": 65,
      "changed_files": 6,
      "url": "https://github.com/elastic/elasticsearch/pull/104257",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104257",
      "commits": [
        {
          "sha": "21c9d5fc8a11321a058fcf83753424ca96c837a7",
          "message": "Add regular feature names to feature metadata extraction.\n\nPlus, fix logic to detect if a feature is \"off\" or \"non-existing\" (wrong, non-existing id). This works only for non-legacy tests, otherwise we log a warning and skip the check."
        },
        {
          "sha": "6334a441fd6fb251f7810bb16eebb0801ae7bbb6",
          "message": "Merge branch 'main' into feature-names-metadata-extractor"
        }
      ],
      "comments": [
        {
          "user": "thecoop",
          "body": "Can use `File.pathSeparator` instead"
        },
        {
          "user": "thecoop",
          "body": "Shouldn't be checking against concrete types - should be `Collection<?>` instead"
        },
        {
          "user": "thecoop",
          "body": "Use `Comparator.naturalOrder()` again"
        },
        {
          "user": "thecoop",
          "body": "Using concrete type again"
        },
        {
          "user": "thecoop",
          "body": "Do we need to catch & hide IOException here? Can't it just propagate?"
        },
        {
          "user": "thecoop",
          "body": "Why a biconsumer here? Why not return `Tuple<Map<,>, Set<>>`?"
        },
        {
          "user": "ldematte",
          "body": "I don't like tuples, they are too \"opaque\" - they make it difficult to tell what is what and to see types"
        }
      ],
      "body": "Today we extract all historical features to a JSON map that is parsed by ESRestTestCase to provide info about historical features. \r\nThis PR adds to that map the list of all names (Ids) of regular features too, so we can reliably raise an error if a feature is not defined.\r\n\r\nThe logic we have today to detect if a feature is \"off\" or \"non-existing\" (wrong, non-existing id) is flawed and works only for historical features. This fixes it. The distinction works only for non-legacy tests; for legacy tests, we log a warning and skip the check.",
      "base_ref": "main",
      "head_ref": "feature-names-metadata-extractor",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104257/comments"
    },
    {
      "number": 104241,
      "title": "Unmute HeapAttack#testHugeManyConcat",
      "state": "closed",
      "created_at": "2024-01-11T00:46:34Z",
      "updated_at": "2024-01-11T18:08:04Z",
      "closed_at": "2024-01-11T18:08:03Z",
      "merged_at": "2024-01-11T18:08:03Z",
      "author": "dnhatn",
      "labels": [
        ">test",
        "Team:Analytics",
        ":Analytics/ES|QL",
        "v8.13.0"
      ],
      "comments_count": 4,
      "review_comments_count": 0,
      "additions": 4,
      "deletions": 1,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104241",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104241",
      "commits": [
        {
          "sha": "239e379dbd9f15d6e098237265fc2956a7dd1a3c",
          "message": "Reduce fields in heap attack tests"
        },
        {
          "sha": "87a28cc3cf2102a3838d35be51b00248eb302669",
          "message": "use the previous fields"
        },
        {
          "sha": "0151d09f76a32817aee9f7f5ff3273c9af506e9e",
          "message": "Merge branch 'main' into reduce-fields"
        }
      ],
      "comments": [],
      "body": "The heap attack recent failures are because of #104240. Analyzing 2000 fields took more than 5 minutes in CI. With the fix in #104246, we can enable this test now.\r\n\r\nRelates #104240",
      "base_ref": "main",
      "head_ref": "reduce-fields",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104241/comments"
    },
    {
      "number": 104231,
      "title": "ESQL: Slightly harden rest tests",
      "state": "closed",
      "created_at": "2024-01-10T21:25:30Z",
      "updated_at": "2024-01-11T12:27:06Z",
      "closed_at": "2024-01-11T12:27:00Z",
      "merged_at": "2024-01-11T12:27:00Z",
      "author": "nik9000",
      "labels": [
        ">test",
        "Team:Analytics",
        ":Analytics/ES|QL",
        "v8.13.0"
      ],
      "comments_count": 2,
      "review_comments_count": 0,
      "additions": 5,
      "deletions": 6,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104231",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104231",
      "commits": [
        {
          "sha": "fbd907a3f175a2ef9e3cdaa9617c26d31af16ad7",
          "message": "ESQL: Slightly harden rest tests\n\nThis attempts to slightly harder our formatting tests by adding a `SORT`\nto them. We've seen some failures that look like the data not arring in\nexpected order. And, without a sort, the order is technically undefined.\n\nCloses #104195"
        }
      ],
      "comments": [],
      "body": "This attempts to slightly harder our formatting tests by adding a `SORT` to them. We've seen some failures that look like the data not arring in expected order. And, without a sort, the order is technically undefined.\r\n\r\nCloses #104195\r\n",
      "base_ref": "main",
      "head_ref": "esql_rest_sort",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104231/comments"
    },
    {
      "number": 104228,
      "title": "Skip heap attack tests in release builds",
      "state": "closed",
      "created_at": "2024-01-10T19:22:56Z",
      "updated_at": "2024-01-10T20:22:04Z",
      "closed_at": "2024-01-10T20:22:03Z",
      "merged_at": "2024-01-10T20:22:03Z",
      "author": "dnhatn",
      "labels": [
        ">test",
        "Team:Analytics",
        ":Analytics/ES|QL",
        "v8.13.0"
      ],
      "comments_count": 2,
      "review_comments_count": 0,
      "additions": 3,
      "deletions": 0,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104228",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104228",
      "commits": [
        {
          "sha": "98156eb60ebcc98c7e601f89949415d86aee615e",
          "message": "Skip heap attack tests in release builds"
        },
        {
          "sha": "423975fcf081db39421106e4e42f5d001d077cf7",
          "message": "import"
        }
      ],
      "comments": [],
      "body": "We need to add a test plugin in the heap attack tests. However, we are not loading test plugins in the release builds; hence, we need to skip this suite.",
      "base_ref": "main",
      "head_ref": "skip-heap-attack-release-builds",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104228/comments"
    },
    {
      "number": 104222,
      "title": "[ML] Unmute MLModelDeploymentsUpgradeIT testTrainedModelDeployment",
      "state": "closed",
      "created_at": "2024-01-10T17:47:08Z",
      "updated_at": "2024-01-11T09:34:39Z",
      "closed_at": "2024-01-11T09:34:35Z",
      "merged_at": "2024-01-11T09:34:35Z",
      "author": "droberts195",
      "labels": [
        ">test",
        ":ml",
        "Team:ML",
        "v8.13.0"
      ],
      "comments_count": 1,
      "review_comments_count": 0,
      "additions": 0,
      "deletions": 2,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104222",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104222",
      "commits": [
        {
          "sha": "606e41585fda36967e1d546a5759a84ac8278fdd",
          "message": "[ML] Do not cache ml-cpp dependencies locally\n\nWhen all the ml-cpp files were in one zip file it was possible\nto cache locally for a while. Now that they are split between\ntwo files this can cause hard-to-debug problems, if one file\nis cached and the other isn't and this happens at a time when\nchanges have been made that need to be consistent between both\nfiles. (Such situations are very rare, which is why this problem\nhasn't been seen before.)\n\nFixes #104193"
        },
        {
          "sha": "a191d95b802a9df2f81ec5ad5f7a53291960fe40",
          "message": "Revert caching change"
        }
      ],
      "comments": [],
      "body": "It seems that this test failure was purely down to inconsistency of ml-cpp dependencies, and not a real problem. Therefore the test can be unmuted.\r\n\r\nFixes #104193",
      "base_ref": "main",
      "head_ref": "no_local_cache_for_ml",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104222/comments"
    },
    {
      "number": 104219,
      "title": "Enable feature flag in node shutdown full cluster restart tests",
      "state": "closed",
      "created_at": "2024-01-10T17:16:46Z",
      "updated_at": "2024-01-10T23:26:34Z",
      "closed_at": "2024-01-10T23:26:11Z",
      "merged_at": "2024-01-10T23:26:11Z",
      "author": "mark-vieira",
      "labels": [
        ">test",
        ":Delivery/Build",
        "Team:Delivery",
        "auto-merge-without-approval",
        "test-release",
        "v8.13.0"
      ],
      "comments_count": 3,
      "review_comments_count": 0,
      "additions": 1,
      "deletions": 0,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104219",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104219",
      "commits": [
        {
          "sha": "239ec022660af468dc0df6e2aa38c99753145996",
          "message": "Enable feature flag in node shutdown full cluster restart tests"
        },
        {
          "sha": "caef91d887332a34e16979b811cce570ae9a2144",
          "message": "Merge branch 'main' into shutdown-bwc-feature-flag"
        },
        {
          "sha": "9011ee78df81566fbc940a1b271746756cd0d7b0",
          "message": "Merge branch 'main' into shutdown-bwc-feature-flag"
        }
      ],
      "comments": [],
      "body": "This should resolve test failures in release builds like [this one](https://gradle-enterprise.elastic.co/s/twbb3r777mhlo/tests/task/:x-pack:plugin:shutdown:qa:full-cluster-restart:v8.12.0%23bwcTest/details/org.elasticsearch.xpack.restart.FullClusterRestartIT/testNodeShutdown%20%7Bcluster%3DUPGRADED%7D?page=eyJvdXRwdXQiOnsiMCI6NX19&top-execution=1).",
      "base_ref": "main",
      "head_ref": "shutdown-bwc-feature-flag",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104219/comments"
    },
    {
      "number": 104217,
      "title": "Remove incorrect is-not-empty asserts in EsqlAsyncActionIT",
      "state": "closed",
      "created_at": "2024-01-10T16:59:43Z",
      "updated_at": "2024-01-10T18:06:28Z",
      "closed_at": "2024-01-10T18:06:28Z",
      "merged_at": "2024-01-10T18:06:28Z",
      "author": "ChrisHegarty",
      "labels": [
        ">test",
        "Team:Analytics",
        ":Analytics/ES|QL",
        "v8.13.0"
      ],
      "comments_count": 1,
      "review_comments_count": 0,
      "additions": 0,
      "deletions": 3,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104217",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104217",
      "commits": [
        {
          "sha": "b044a066abf280e4461f91f968786146cf585f9e",
          "message": "Remove incorrect is_no_empty asserts in EsqlAsyncActionIT"
        },
        {
          "sha": "69eb51f66f807d86c77a9aa8501dfb45cb1a25f8",
          "message": "import"
        }
      ],
      "comments": [],
      "body": "This commit removes a couple of incorrect is-not-empty asserts in EsqlAsyncActionIT. \r\n\r\nThe original intent of the asserts here was to try to ensure that the completed results are valid - there should be a result. However, there are some test scenarios where an empty list of columns and values is actually the expected and correct result. The asserts are not need, not correct, and should just be removed. The results will be asserted by the caller when the response is returned.\r\n\r\ncloses #104214",
      "base_ref": "main",
      "head_ref": "esql_async_test_empty_fix",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104217/comments"
    },
    {
      "number": 104216,
      "title": "ESQL: Allow custom delimiters in CsvTestsDataLoader",
      "state": "closed",
      "created_at": "2024-01-10T16:55:44Z",
      "updated_at": "2024-01-22T07:47:59Z",
      "closed_at": "2024-01-22T07:47:55Z",
      "merged_at": null,
      "author": "iverase",
      "labels": [
        ">test",
        "Team:Analytics",
        ":Analytics/ES|QL",
        "v8.13.0"
      ],
      "comments_count": 5,
      "review_comments_count": 0,
      "additions": 26,
      "deletions": 22,
      "changed_files": 2,
      "url": "https://github.com/elastic/elasticsearch/pull/104216",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104216",
      "commits": [
        {
          "sha": "64516eacc4bb439ae092c71bb03a976df1919585",
          "message": "Allow custom delimiters in CsvTestsDataLoader"
        },
        {
          "sha": "fd9c35ff21f7b9de5f7c628cde07e5feb5abd45c",
          "message": "Move delimiter to `delimitedListToStringArray`"
        }
      ],
      "comments": [],
      "body": "It is currently not possible to generate datasets if any of the fields contain a comma. To avoid this limitation we can allow each dataset to define its own delimiter so they can overcome this limitation.",
      "base_ref": "main",
      "head_ref": "CsvTestsDataLoader",
      "mergeable": false,
      "mergeable_state": "dirty",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104216/comments"
    },
    {
      "number": 104213,
      "title": "Find break limits for DocBlock tests on fly",
      "state": "closed",
      "created_at": "2024-01-10T16:25:49Z",
      "updated_at": "2024-01-12T17:40:35Z",
      "closed_at": "2024-01-12T17:40:34Z",
      "merged_at": "2024-01-12T17:40:34Z",
      "author": "dnhatn",
      "labels": [
        ">test",
        "Team:Analytics",
        ":Analytics/ES|QL",
        "v8.13.0"
      ],
      "comments_count": 3,
      "review_comments_count": 2,
      "additions": 69,
      "deletions": 43,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104213",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104213",
      "commits": [
        {
          "sha": "0e24c0dedf8a92458a40c45515d19e4fa9144550",
          "message": "Find break limits for DocBlock tests on fly"
        },
        {
          "sha": "dcaead1c30ab9f4cf7c26aa85867f8aee6871632",
          "message": "Merge branch 'main' into fix-doc-break"
        },
        {
          "sha": "faaeb89764e3c649a22c7442d84c5edb939a0e62",
          "message": "Feedback"
        }
      ],
      "comments": [
        {
          "user": "nik9000",
          "body": "I don't think we need the MAX limit test if we're going to find this on the fly. The act of finding it confirms that it breaks."
        },
        {
          "user": "nik9000",
          "body": "I'd move this to the tests that need them. If the build process doesn't properly release on failure this could leave behind un-released blocks. Better to have that fail in the test, i think."
        }
      ],
      "body": "The test failure is related to #104159, where we had an overestimate of the RAM usage for X-ArrayVector. Instead of updating the break limits, this PR uses the breaker utility that @nik9000  wrote to dynamically compute the limits on-the-fly.\r\n\r\nCloses #104191",
      "base_ref": "main",
      "head_ref": "fix-doc-break",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104213/comments"
    },
    {
      "number": 104210,
      "title": "ESQL: Fix bug in topn tests",
      "state": "closed",
      "created_at": "2024-01-10T15:23:56Z",
      "updated_at": "2024-01-12T18:03:35Z",
      "closed_at": "2024-01-12T18:03:12Z",
      "merged_at": "2024-01-12T18:03:12Z",
      "author": "nik9000",
      "labels": [
        ">test",
        "Team:Analytics",
        "auto-merge-without-approval",
        ":Analytics/ES|QL",
        "v8.13.0"
      ],
      "comments_count": 1,
      "review_comments_count": 2,
      "additions": 226,
      "deletions": 102,
      "changed_files": 19,
      "url": "https://github.com/elastic/elasticsearch/pull/104210",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104210",
      "commits": [
        {
          "sha": "b16b5f868a6014912fb3c89c0f27e0e221473523",
          "message": "ESQL: Fix bug in topn tests\n\nThis fixes a bug in the topn tests which failed because we tried to sort\nof a geo field. Geo fields aren't valid sort keys but the test is\nrandomized and rarely picks them. This stops it from picking them."
        },
        {
          "sha": "717da5033bdcfdf4cf42971301b404ac3595dde0",
          "message": "Merge branch 'main' into fix_104167"
        },
        {
          "sha": "1e0b4ec3aca51082ce0ac3549d946091e88ce404",
          "message": "Reenable"
        }
      ],
      "comments": [
        {
          "user": "nik9000",
          "body": "I added all of this to make debugging eaier."
        },
        {
          "user": "nik9000",
          "body": "And this is the real fix."
        }
      ],
      "body": "This fixes a bug in the topn tests which failed because we tried to sort of a geo field. Geo fields aren't valid sort keys but the test is randomized and rarely picks them. This stops it from picking them.\r\n\r\nMost of the text of this change is actually just me making debugging easier.\r\n\r\nCloses #104167",
      "base_ref": "main",
      "head_ref": "fix_104167",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104210/comments"
    },
    {
      "number": 104205,
      "title": "ESQL: Run yaml tests async",
      "state": "closed",
      "created_at": "2024-01-10T13:35:42Z",
      "updated_at": "2024-01-10T20:58:36Z",
      "closed_at": "2024-01-10T20:58:13Z",
      "merged_at": "2024-01-10T20:58:13Z",
      "author": "nik9000",
      "labels": [
        ">test",
        "Team:Analytics",
        "auto-merge-without-approval",
        ":Analytics/ES|QL",
        "v8.13.0"
      ],
      "comments_count": 1,
      "review_comments_count": 0,
      "additions": 295,
      "deletions": 37,
      "changed_files": 9,
      "url": "https://github.com/elastic/elasticsearch/pull/104205",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104205",
      "commits": [
        {
          "sha": "609db2f7974a7c44c8c11248faf226100ae26e41",
          "message": "ESQL: Run yaml tests async\n\nThis adds tests that run the our suite of yaml tests against the ESQL\nasync endpoint. That's quite nice because the yaml tests are where we\nhandle lots of fun error cases and this'll make sure async does sensible\nthings in those cases."
        },
        {
          "sha": "b9dbdddc053cb80f43422ab404520f1329998abb",
          "message": "Merge branch 'main' into esql_yaml_tests_async"
        },
        {
          "sha": "b18e5a8031097783e891b15f753aca568e0910dd",
          "message": "Spotless"
        }
      ],
      "comments": [],
      "body": "This adds tests that run the our suite of yaml tests against the ESQL async endpoint. That's quite nice because the yaml tests are where we handle lots of fun error cases and this'll make sure async does sensible things in those cases.\r\n",
      "base_ref": "main",
      "head_ref": "esql_yaml_tests_async",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104205/comments"
    },
    {
      "number": 104192,
      "title": "Fix TextFieldMapperTests",
      "state": "closed",
      "created_at": "2024-01-10T10:56:43Z",
      "updated_at": "2024-01-11T08:58:21Z",
      "closed_at": "2024-01-11T08:58:21Z",
      "merged_at": "2024-01-11T08:58:21Z",
      "author": "luigidellaquila",
      "labels": [
        ">test",
        "Team:Analytics",
        ":Analytics/ES|QL",
        "v8.13.0"
      ],
      "comments_count": 7,
      "review_comments_count": 0,
      "additions": 48,
      "deletions": 64,
      "changed_files": 3,
      "url": "https://github.com/elastic/elasticsearch/pull/104192",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104192",
      "commits": [
        {
          "sha": "78dd133631470916ff6ebe6779868da17ac55b6c",
          "message": "Revert \"Muting testBlockLoader tests for TextFieldMapperTests (#104163)\"\n\nThis reverts commit 198261687973699f7da776da345b7a46365e7a0e."
        },
        {
          "sha": "3779bf81ec87ed5b97f9e6764233b7cfedf96808",
          "message": "Improve TextFieldMapperTests"
        },
        {
          "sha": "f608e555287fbcc348c29db4b20041eb8a2b0b67",
          "message": "Rework expected\n\nIt was super confusing. Now it should be ok!"
        },
        {
          "sha": "a9e68196e8d98bea4354370401d54580e34e1564",
          "message": "spotless"
        },
        {
          "sha": "2b270dde040273d24c810bcaa1c9c790f4ec7b8f",
          "message": "Merge branch 'main' into fix_104152"
        }
      ],
      "comments": [],
      "body": "Fixes https://github.com/elastic/elasticsearch/issues/104152\r\n\r\nThe introduction of more strict checks on using subfields to load the exact value of a TEXT field - mostly for ES|QL - (ie. not loading data from subfields when they don't have the exact same value as the parent field, eg. because of `ignore_above`) triggered some errors in this test.\r\n\r\n\r\n",
      "base_ref": "main",
      "head_ref": "fix_104152",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104192/comments"
    },
    {
      "number": 104173,
      "title": "[8.11] Reduce concurrency of execution for x-pack full cluster restart tests (#104166)",
      "state": "closed",
      "created_at": "2024-01-09T22:31:42Z",
      "updated_at": "2024-01-09T23:07:48Z",
      "closed_at": "2024-01-09T23:07:25Z",
      "merged_at": "2024-01-09T23:07:25Z",
      "author": "mark-vieira",
      "labels": [
        ">test",
        ":Delivery/Build",
        "backport",
        "Team:Delivery",
        "auto-merge-without-approval",
        "v8.11.5"
      ],
      "comments_count": 0,
      "review_comments_count": 0,
      "additions": 1,
      "deletions": 0,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104173",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104173",
      "commits": [
        {
          "sha": "9332f3c8b4b374d1d4c845a51e1d0053410a79c9",
          "message": "Reduce concurrency of execution for x-pack full cluster restart tests (#104166)"
        }
      ],
      "comments": [],
      "body": "Backports the following commits to 8.11:\n - Reduce concurrency of execution for x-pack full cluster restart tests (#104166)",
      "base_ref": "8.11",
      "head_ref": "backport/8.11/pr-104166",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104173/comments"
    },
    {
      "number": 104172,
      "title": "[8.12] Reduce concurrency of execution for x-pack full cluster restart tests (#104166)",
      "state": "closed",
      "created_at": "2024-01-09T22:31:23Z",
      "updated_at": "2024-01-09T23:11:49Z",
      "closed_at": "2024-01-09T23:11:26Z",
      "merged_at": "2024-01-09T23:11:26Z",
      "author": "mark-vieira",
      "labels": [
        ">test",
        ":Delivery/Build",
        "backport",
        "Team:Delivery",
        "auto-merge-without-approval",
        "v8.12.1"
      ],
      "comments_count": 0,
      "review_comments_count": 0,
      "additions": 1,
      "deletions": 0,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104172",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104172",
      "commits": [
        {
          "sha": "562925c442915b2dc9875a75c1bb47526cc0aa2e",
          "message": "Reduce concurrency of execution for x-pack full cluster restart tests (#104166)"
        }
      ],
      "comments": [],
      "body": "Backports the following commits to 8.12:\n - Reduce concurrency of execution for x-pack full cluster restart tests (#104166)",
      "base_ref": "8.12",
      "head_ref": "backport/8.12/pr-104166",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104172/comments"
    },
    {
      "number": 104166,
      "title": "Reduce concurrency of execution for x-pack full cluster restart tests",
      "state": "closed",
      "created_at": "2024-01-09T21:41:51Z",
      "updated_at": "2024-01-09T22:31:54Z",
      "closed_at": "2024-01-09T22:29:33Z",
      "merged_at": "2024-01-09T22:29:33Z",
      "author": "mark-vieira",
      "labels": [
        ">test",
        ":Delivery/Build",
        "Team:Delivery",
        "v8.12.1",
        "v8.13.0",
        "v8.11.5"
      ],
      "comments_count": 2,
      "review_comments_count": 0,
      "additions": 1,
      "deletions": 0,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104166",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104166",
      "commits": [
        {
          "sha": "c48bc6217c530cf15ba74cd08999f450b7db2801",
          "message": "Reduce concurrency of execution for x-pack full cluster restart tests"
        }
      ],
      "comments": [],
      "body": "This suite has a number of tests, each spins up a 2 node cluster, and we often see timeouts here. This is likely due to resource contention of too many parallel nodes running. Let's just reduce the concurrency here until we have a better solution for shared clusters in upgrade tests. This is going to extend test execution but should improve stability.",
      "base_ref": "main",
      "head_ref": "reduce-xpack-bwc-parallelization",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104166/comments"
    },
    {
      "number": 104165,
      "title": "Relax incorrect assertion in SnapshotShutdownIT",
      "state": "closed",
      "created_at": "2024-01-09T21:36:55Z",
      "updated_at": "2024-06-17T06:17:30Z",
      "closed_at": "2024-01-10T07:57:10Z",
      "merged_at": "2024-01-10T07:57:10Z",
      "author": "DaveCTurner",
      "labels": [
        ">test",
        ":Distributed Coordination/Snapshot/Restore",
        "Team:Distributed (Obsolete)",
        "v8.13.0"
      ],
      "comments_count": 3,
      "review_comments_count": 0,
      "additions": 5,
      "deletions": 0,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104165",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104165",
      "commits": [
        {
          "sha": "2057488ab57710d98ff67659f8d9257cac4d4869",
          "message": "Relax incorrect assertion in SnapshotShutdownIT\n\nIt's (just about) possible for the data node to apply the initial\nsnapshot state, start on the first shard snapshot, and hit the IO block,\nbefore the master even applies this cluster state, so we cannot assert\nthat the snapshot has started when creating the snapshot-paused\nlistener. This commit fixes the problem by retrying when encountering\nthat state.\n\nRelates #101717"
        }
      ],
      "comments": [],
      "body": "It's (just about) possible for the data node to apply the initial\r\nsnapshot state, start on the first shard snapshot, and hit the IO block,\r\nbefore the master even applies this cluster state, so we cannot assert\r\nthat the snapshot has started when creating the snapshot-paused\r\nlistener. This commit fixes the problem by retrying when encountering\r\nthat state.\r\n\r\nRelates #101717",
      "base_ref": "main",
      "head_ref": "2024/01/09/SnapshotShutdownIT-snapshot-paused-listener-before-snapshot-start",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104165/comments"
    },
    {
      "number": 104151,
      "title": "Wait for async actions in AsyncOperator tests",
      "state": "closed",
      "created_at": "2024-01-09T17:31:59Z",
      "updated_at": "2024-01-09T18:32:20Z",
      "closed_at": "2024-01-09T18:32:19Z",
      "merged_at": "2024-01-09T18:32:19Z",
      "author": "dnhatn",
      "labels": [
        ">test",
        "Team:Analytics",
        ":Analytics/ES|QL",
        "v8.13.0"
      ],
      "comments_count": 2,
      "review_comments_count": 0,
      "additions": 4,
      "deletions": 0,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104151",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104151",
      "commits": [
        {
          "sha": "d63d43b8f1cf3d77aab633c191acd1f8b0e4ee3e",
          "message": "Wait for async actions in AsyncOperator tests"
        }
      ],
      "comments": [],
      "body": "We must wait for the async lookups in AsyncOperator to complete before ending the test to ensure that all blocks are released.\r\n\r\nCloses #104130",
      "base_ref": "main",
      "head_ref": "fix-async-leak",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104151/comments"
    },
    {
      "number": 104140,
      "title": "YAML test framework: separate `skip` and `requires` sections ",
      "state": "closed",
      "created_at": "2024-01-09T15:32:30Z",
      "updated_at": "2024-01-15T13:48:40Z",
      "closed_at": "2024-01-15T13:48:36Z",
      "merged_at": "2024-01-15T13:48:36Z",
      "author": "ldematte",
      "labels": [
        ">test",
        ":Core/Infra/Core",
        ">refactoring",
        "Team:Core/Infra",
        "v8.13.0"
      ],
      "comments_count": 3,
      "review_comments_count": 11,
      "additions": 1280,
      "deletions": 719,
      "changed_files": 17,
      "url": "https://github.com/elastic/elasticsearch/pull/104140",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104140",
      "commits": [
        {
          "sha": "9561c7fdac1f8133efc637d43d6600015465605f",
          "message": "Introduce SkipVersionContext and consolidate skip() methods"
        },
        {
          "sha": "45483d9de9ab59bca0cfbd606d042af9cfc04a64",
          "message": "Merge remote-tracking branch 'upstream/main' into refactoring-yaml-skipsection"
        },
        {
          "sha": "1be2797d808a12203acaab126b9180d138b3d6ae",
          "message": "Intermediate step: moved section construction to a builder"
        },
        {
          "sha": "ecf247e7ba67d7195e488f988860757586348c25",
          "message": "Introduce SkipCriteria for modular skip decisions\n\n- Refined SkipSectionContext to uniform boolean tests on the cluster properties\n- Removed accessors to specific criteria from SkipSection (used only on tests), adjusted test assertions\n- Version range checks commented out, as they have been already addressed in a pending PR (#103311)"
        },
        {
          "sha": "b47f1b445dfb4ffa01fb646c9cd03458f1e8d6f7",
          "message": "spotless"
        },
        {
          "sha": "a84602c5896a68f64fe566c1a3a5ce69a3cd6d29",
          "message": "Refactoring tests\n\n- moving and adding VersionRange tests\n- adding specific version and os skip tests\n- modified parse/validate/build to make SkipSection more unit-testable"
        },
        {
          "sha": "724d563ec4e87ae3b2748c159ab78f9d944df882",
          "message": "spotless"
        },
        {
          "sha": "bc206b98b83d46e64f1faf506aae144c3579fab2",
          "message": "Update external parse tests"
        },
        {
          "sha": "0235c0b93459f70fec62e554d8467c693a94132b",
          "message": "Separate and refine skip tests"
        },
        {
          "sha": "35d638b85dd56d0bdecb9828442bcb4c11d5f677",
          "message": "Merge remote-tracking branch 'upstream/main' into refactoring-yaml-skipsection"
        },
        {
          "sha": "91def96c06cc7b1783f5f4fe1a6d80c43e15aaba",
          "message": "spotless"
        },
        {
          "sha": "e31989e583799a507da401d967459d8678dbe3d6",
          "message": "Merge remote-tracking branch 'upstream/main' into refactoring-yaml-skipsection"
        },
        {
          "sha": "f5fcbb72fc7dc6c9a3c8183ce5ceb2e41bde2e3a",
          "message": "Simplify\n\n- Remove SkipSectionContext\n- Replace SkipCriteria interface with Predicate + factory\n- Moved Features check (YAML test runner features) to SkipSection build time"
        },
        {
          "sha": "3f8881401aa51af9ef29fa641254c350b6995f52",
          "message": "Merge remote-tracking branch 'upstream/main' into refactoring-yaml-skipsection"
        },
        {
          "sha": "d7ced4cfa10daee9c918566eb36164bccf3132de",
          "message": "Separated check for xpack/no_xpack\n\nCheck for xpack is cluster-configuration (modules installed) dependent, while Features are meant to be \"static\" test-runner capabilities. We separate them so checks on one (test-runner features) can be run before and separately from the other."
        },
        {
          "sha": "7259664cf866422c494c42eed534a48cd8c54bb4",
          "message": "Merge remote-tracking branch 'upstream/main' into refactoring-yaml-skipsection"
        },
        {
          "sha": "3d307b329dfe420c964e708c8e936b8075025c84",
          "message": "Fix Version/Strings nodeVersions mismatch after merge"
        },
        {
          "sha": "0573d2021ec42663a1beeb4c464f39ef2bcb28af",
          "message": "Addressing comments\n\n- removed not-so-helpful toString for Version SkipCriteria\n- renaming\n- removed un-needed file"
        },
        {
          "sha": "f0c64ee50f70e3494c22289a2a6a7f59e672b5c3",
          "message": "Merge remote-tracking branch 'upstream/main' into refactoring-yaml-skipsection"
        },
        {
          "sha": "ce3e2eb8e8f978c8feadfb52d3333127475757f0",
          "message": "Adding cluster feature-based skip criteria"
        },
        {
          "sha": "0d4ceec79a3042f7e479c50942ab6a08c9c24b0a",
          "message": "remove final"
        },
        {
          "sha": "9ec34e8a8b08e1581af405f6985072e86c73ba05",
          "message": "Renaming"
        },
        {
          "sha": "d97c7fcda2329e5bb5f56b2b10e061d8b899152b",
          "message": "More renaming"
        },
        {
          "sha": "47709fb226736bbbf8d38b3f0680607754777e03",
          "message": "Merge remote-tracking branch 'upstream/main' into add-features-yaml-skipsection"
        },
        {
          "sha": "fb7c5b92c2c5d3c5562eba1133a8b606424465eb",
          "message": "Using set intersection function"
        },
        {
          "sha": "1ed9d7b6882bd9464ee61cb256f6485756124a7a",
          "message": "Merge branch 'main' into add-features-yaml-skipsection"
        },
        {
          "sha": "d82bcf1ee8e4649e78b9fb7f15600214b2ec967e",
          "message": "Change parser signature and rename"
        },
        {
          "sha": "215da960f1a09bfa4d35b64976adebd069cb9166",
          "message": "Divide require and skip predicates"
        },
        {
          "sha": "eb88128193c67879f863db24fd46d73b8751d1b2",
          "message": "Divide requires and skip parsing (distinct sections)"
        },
        {
          "sha": "f0094b3bc8413d6f5ffcf883db8aadde3f1e7449",
          "message": "Merge remote-tracking branch 'upstream/main' into add-features-yaml-skipsection"
        }
      ],
      "comments": [
        {
          "user": "mosche",
          "body": "Very optional nit, feel free to ignore, for consistency these could be:\r\n- `[forbidden|skipped]Version`\r\n- `[forbidden|skipped]OperatingSystems`\r\n- `[forbidden|skipped]ClusterFeatures`"
        },
        {
          "user": "mosche",
          "body": "nit, maybe `yamlRunnerRequiresFeature` is easier to understand?"
        },
        {
          "user": "mosche",
          "body": "Should this be renamed? `hasYamlRunnerFeature` or similar"
        },
        {
          "user": "mosche",
          "body": "Should we log a warning here and let people know how to migrate? "
        },
        {
          "user": "mosche",
          "body": "Same as above, log a warning?"
        },
        {
          "user": "mosche",
          "body": "require`s`Criteria vs requireCriteria, not sure if that is intended"
        },
        {
          "user": "mosche",
          "body": "👍 "
        },
        {
          "user": "mosche",
          "body": "Just a thought, how about appending that to the `requiresReason` in the builder when required runner features are missing?"
        },
        {
          "user": "ldematte",
          "body": "For consistency with `ClientYamlTestSuite`, I have renamed all as `hasYamlRunnerFeature`"
        },
        {
          "user": "ldematte",
          "body": "Added"
        },
        {
          "user": "ldematte",
          "body": "It's a good idea, but I prefer to leave it as is for now, so the output message does not change too much."
        }
      ],
      "body": "This PR introduces a new `requires` field in parallel to the existing `skip` field; after trying out more elaborate alternatives, I choose to keep the change minimal wrt https://github.com/elastic/elasticsearch/pull/103909 and previous refactoring. Since renaming `SkipSection` to `PrerequisiteSection` (as it was strange to keep the name \"Skip\" when it contains both `skip` and `requires`) is making things muddier, this is what changed:\r\n- parseIfNext/parseInternal is now \"detecting\" both `skip` and `requires` (in any order)\r\n- parseInternal is split into (acutally, delegates) parseSkipSection and parseRequiresSection\r\n- parseSkipSection and parseRequiresSection are the same as before -- except each accepts and parses a sub-selection of fields.\r\n- the builder introduced previously is the same, and it is shared by parseSkipSection and parseRequiresSection; this keeps the change minimal but also make cross-field validation easier.\r\n\r\nIn a first iteration, I think about keeping `skip: features: ...` so we do not have to mix a monster change with this PR; I have added `requires: test_runner_features: ...` in parallel. We can migrate tests to that separately.\r\n\r\nSee `PrerequisiteSectionTests` for how it looks like. An example: \r\n\r\n```\r\nrequires:\r\n   test_runner_features:  some-runner feature\r\n   cluster_features:      needed-feature\r\n   reason:                test needs needed-feature to run\r\nskip:\r\n   cluster_features:      undesired-feature\r\n   reason:                test cannot run when undesired-feature are present\r\n```",
      "base_ref": "main",
      "head_ref": "add-features-yaml-requiresection",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104140/comments"
    },
    {
      "number": 104133,
      "title": "ESQL: Update some QA suites to allow running in Serverless",
      "state": "closed",
      "created_at": "2024-01-09T14:17:35Z",
      "updated_at": "2024-01-09T16:25:26Z",
      "closed_at": "2024-01-09T16:25:24Z",
      "merged_at": "2024-01-09T16:25:24Z",
      "author": "bpintea",
      "labels": [
        ">test",
        "Team:Analytics",
        ":Analytics/ES|QL",
        "v8.13.0"
      ],
      "comments_count": 2,
      "review_comments_count": 2,
      "additions": 4,
      "deletions": 3,
      "changed_files": 5,
      "url": "https://github.com/elastic/elasticsearch/pull/104133",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104133",
      "commits": [
        {
          "sha": "517fcf7c7b76a2245a47e57aeec58a3805a3d599",
          "message": "Update some QA suites to run in Serverless\n\nThis applies the changes needed to have single-node and heap-atack\nsuites run in Serverless."
        }
      ],
      "comments": [
        {
          "user": "bpintea",
          "body": "Setting node count isn't supported in Serverless.\r\nConsidering that `1` is the default, I think the easiest is to just remove the setting. This would be preferred IMO to \"detecting\" the environment."
        },
        {
          "user": "mark-vieira",
          "body": "👍 "
        }
      ],
      "body": "This applies the changes needed to have `single-node` and `heap-atack` suites run in Serverless.\r\n",
      "base_ref": "main",
      "head_ref": "esql/qa_sn_ha_serverless",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104133/comments"
    },
    {
      "number": 104123,
      "title": "Expand uses of matchers for Optionals",
      "state": "closed",
      "created_at": "2024-01-09T11:03:26Z",
      "updated_at": "2024-01-09T12:55:52Z",
      "closed_at": "2024-01-09T12:55:30Z",
      "merged_at": "2024-01-09T12:55:30Z",
      "author": "thecoop",
      "labels": [
        ">test",
        ":Core/Infra/Core",
        ">refactoring",
        "Team:Core/Infra",
        "v8.13.0"
      ],
      "comments_count": 2,
      "review_comments_count": 0,
      "additions": 231,
      "deletions": 153,
      "changed_files": 24,
      "url": "https://github.com/elastic/elasticsearch/pull/104123",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104123",
      "commits": [
        {
          "sha": "c1d5fbc5751bc5d553bf5759d90fbdbf5328def9",
          "message": "Expand uses of OptionalMatchers"
        },
        {
          "sha": "cc8c4f4e4af897c266b0cc0a6847ee30710fa61f",
          "message": "Add tests for OptionalMatchers"
        },
        {
          "sha": "60f84141891f9ec9155a79e2a01c15d65fa055ac",
          "message": "Remove superfluous check"
        }
      ],
      "comments": [],
      "body": "We already have `OptionalMatchers` - expand the uses of this class, and create new methods to assert specific optional values",
      "base_ref": "main",
      "head_ref": "optional-matchers",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104123/comments"
    },
    {
      "number": 104116,
      "title": "[Test] Ensure indices are healthy enough before closing (#101023)",
      "state": "closed",
      "created_at": "2024-01-09T09:40:06Z",
      "updated_at": "2024-06-17T06:17:30Z",
      "closed_at": "2024-01-09T10:18:04Z",
      "merged_at": "2024-01-09T10:18:04Z",
      "author": "DaveCTurner",
      "labels": [
        ">test",
        ":Distributed Coordination/Snapshot/Restore",
        "backport",
        "auto-merge-without-approval",
        "v8.11.5"
      ],
      "comments_count": 0,
      "review_comments_count": 0,
      "additions": 24,
      "deletions": 9,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104116",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104116",
      "commits": [
        {
          "sha": "21c89f3a9310f4eea95ae643e43421566690d932",
          "message": "[Test] Ensure indices are healthy enough before closing (#101023)\n\nClosing unassigned indices is not cleanly handled. This change avoids\r\ndoing so in the test.\r\n\r\nResolves: #99516"
        }
      ],
      "comments": [],
      "body": "Closing unassigned indices is not cleanly handled. This change avoids\r\ndoing so in the test.\r\n\r\nBackport of #101023 to 8.11\r\nRelates #99516\r\nCloses #104072",
      "base_ref": "8.11",
      "head_ref": "2024/01/09/backport-101023-8.11",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104116/comments"
    },
    {
      "number": 104112,
      "title": "Unmute DownsampleActionIT.testTsdbDataStreams() test",
      "state": "closed",
      "created_at": "2024-01-09T08:28:39Z",
      "updated_at": "2024-01-10T09:30:10Z",
      "closed_at": "2024-01-10T09:30:10Z",
      "merged_at": "2024-01-10T09:30:10Z",
      "author": "martijnvg",
      "labels": [
        ">test",
        "needs:triage",
        ":StorageEngine/Downsampling",
        "v8.13.0"
      ],
      "comments_count": 0,
      "review_comments_count": 0,
      "additions": 1,
      "deletions": 1,
      "changed_files": 2,
      "url": "https://github.com/elastic/elasticsearch/pull/104112",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104112",
      "commits": [
        {
          "sha": "1f7cc5e0cfb6c6e5ad41bf424d3db1ceabc1f2c6",
          "message": "Unmute DownsampleActionIT.testTsdbDataStreams() test"
        }
      ],
      "comments": [],
      "body": "- More logging was added this should give more insight in the next failure.\r\n- Increased the `time_series.poll_interval` setting.  The time when the `index.time_series.end_time` index setting gets updated by `UpdateTimeSeriesRangeService` is the likely cause of the test failure.",
      "base_ref": "main",
      "head_ref": "downsample/unmute_testTsdbDataStreams",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104112/comments"
    },
    {
      "number": 104109,
      "title": "[Test] Disable rare actions in RepoAnalysisFailureIT",
      "state": "closed",
      "created_at": "2024-01-09T03:30:48Z",
      "updated_at": "2024-01-23T23:25:55Z",
      "closed_at": "2024-01-23T23:25:55Z",
      "merged_at": "2024-01-23T23:25:55Z",
      "author": "ywangd",
      "labels": [
        ">test",
        ":Distributed Coordination/Snapshot/Restore",
        "Team:Distributed (Obsolete)",
        "v8.13.0"
      ],
      "comments_count": 5,
      "review_comments_count": 13,
      "additions": 9,
      "deletions": 0,
      "changed_files": 1,
      "url": "https://github.com/elastic/elasticsearch/pull/104109",
      "api_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104109",
      "commits": [
        {
          "sha": "1791217d8d3762bba5d23f3b8c0ed1e5ea5f2a1f",
          "message": "[Test] More robust disruption for blob read\n\nWhen it is time to interupt and the actual content is null, we now send\nback a random byte instead of null so that the disruption happens at all\ntime.\n\nResolves: #103791"
        },
        {
          "sha": "4df837d31dc04ed9e7f761ff2bbf36b50993f06a",
          "message": "Revert \"[Test] More robust disruption for blob read\"\n\nThis reverts commit 1791217d8d3762bba5d23f3b8c0ed1e5ea5f2a1f."
        },
        {
          "sha": "ff32a725887899a254fc4ae1a6254ffb308fca57",
          "message": "Merge remote-tracking branch 'origin/main' into es-103791-testFailsOnChecksumMismatch"
        },
        {
          "sha": "081857dab4a2e0fde59b6838e45d1ac67421728e",
          "message": "[CI] Disable rare actions in RepoAnalysisFailureIT\n\nRare actions are disabled to improve CI stability.\n\nResolves: #104109"
        },
        {
          "sha": "bb20b272c589bb295ac26efae036a175a72e500a",
          "message": "expand comment"
        },
        {
          "sha": "b31d1bfd0f3abb2b2841c342d416bcdb4e403bc1",
          "message": "tweak"
        },
        {
          "sha": "0362b1a115c6ff150fdd3ebdb89f5883898517e6",
          "message": "adjust comment"
        }
      ],
      "comments": [
        {
          "user": "ywangd",
          "body": "I did not reproduce the failure so that this is a best-effort attempt to fix. It seems plausible that in edge cases the `countDown` may not reach to 0 (hence no disruption) if there are many null `actualContents` or it happens towards the end of total read requests."
        },
        {
          "user": "idegtiarenko",
          "body": "I think it is worth moving to a dedicated assertion prior this one."
        },
        {
          "user": "idegtiarenko",
          "body": "Why `actualContents` might be null? Also can it be 0 length?"
        },
        {
          "user": "ywangd",
          "body": "I just noticed it can be `null` but I am actually not sure why. I guess it might related to early read (read before write completes)? @DaveCTurner could you please help out here?\r\n\r\nI don't think length can be `0`. Otherwise we will see assertion error from `randomLongBetween(0, length - 1)`."
        },
        {
          "user": "ywangd",
          "body": "I thought about that. But it is not possible to assert `countDown` without excuting the analysis. But once the analysis is executed we need to check the error it throws first. So there is an order issue."
        },
        {
          "user": "ywangd",
          "body": "I think this is no longer needed because rare action is disabled. I left it untouched in case it might be more informational (it might be disabled for different reasons?)"
        },
        {
          "user": "DaveCTurner",
          "body": "Could you make this more specific than just \"CI instability\", describing how overwrites causes the test failure? I don't think early-reads will be an issue here?"
        },
        {
          "user": "ywangd",
          "body": "IIUC, early-reads are the reason why we consider checksums of both \"write\" and \"overwrite\" contents to be correct. This lieniency is what allows the issue to happen. Normal reads should always return the \"overwrite\" content and not having this issue. I expanded the comment as suggested. Please let me know if it reads right to you. Thanks!"
        },
        {
          "user": "DaveCTurner",
          "body": "Ah not quite, the overwrite happens in the \"read phase\", reads that are concurrent with the overwrite do not count as early:\r\n\r\nhttps://github.com/elastic/elasticsearch/blob/3031595d6a234c31abe9f7da74a86a72d30d0652/x-pack/plugin/snapshot-repo-test-kit/src/main/java/org/elasticsearch/repositories/blobstore/testkit/BlobAnalyzeAction.java#L106-L117"
        },
        {
          "user": "ywangd",
          "body": "I could some help to understand the code. I don't quite get how Read phase starts before Overwrite. Is this the relevant code?\r\n\r\nhttps://github.com/elastic/elasticsearch/blob/3031595d6a234c31abe9f7da74a86a72d30d0652/x-pack/plugin/snapshot-repo-test-kit/src/main/java/org/elasticsearch/repositories/blobstore/testkit/BlobAnalyzeAction.java#L282-L286\r\n\r\nIt seems to me that Ovewrite starts first with `writeRandomBlob` and the Read starts right before the last byte of the new content is written?"
        },
        {
          "user": "DaveCTurner",
          "body": "That sounds about right, but this isn't an early read."
        },
        {
          "user": "ywangd",
          "body": "OK I think I understand your point now. This regular read can also possibly return the old content because the overwrite is still ongoing and may not complete before the read returns. So yeah, this read also needs the lenient checksum comparison. I have adjusted the comment accordingly. "
        },
        {
          "user": "DaveCTurner",
          "body": "Yep that's right LGTM"
        }
      ],
      "body": "Rare actions are disabled to improve CI stability.\r\n\r\nResolves: #103791\r\n",
      "base_ref": "main",
      "head_ref": "es-103791-testFailsOnChecksumMismatch",
      "mergeable": null,
      "mergeable_state": "unknown",
      "review_comments_url": "https://api.github.com/repos/elastic/elasticsearch/pulls/104109/comments"
    }
  ]
}